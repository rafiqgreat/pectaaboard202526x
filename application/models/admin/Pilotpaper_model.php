<?php

	class Pilotpaper_model extends CI_Model{

		public function getPilotParagraphsCRQs($subject_id)

		{

			$sqlx="SELECT GROUP_CONCAT(para_id)  AS para_crq_ids FROM `ci_items_paragraphs_pilot` LEFT JOIN `ci_items_pilot` i1 ON i1.item_id = para_item_21 WHERE para_rev_ae_status = 2 AND para_subject_id  = ".$subject_id." AND i1.item_type = 'ERQ'";

			$queryx = $this->db->query($sqlx);

			return  $queryx->result();

		}

		public function getPilotIndivisualCRQsPhase1($subject_id,$phase=1)

		{			

			$sqlx="SELECT c_ind_crq_ids FROM ci_pilot_papers_crqs WHERE	c_phase = ".$phase." AND c_subject_id = ".$subject_id;

			$queryx = $this->db->query($sqlx);

			return  $queryx->result();			

		}		

		public function getPilotCRQsPhase($phase=2)

		{

			$sqlx="SELECT * FROM ci_pilot_papers_crqs WHERE	c_phase = ".$phase." ORDER BY c_grade_id ASC, c_subject_id ASC ";

			$queryx = $this->db->query($sqlx);

			return  $queryx->result();

		}

		public function getPilotIndivisualCRQsAll($subject_id)

		{

			

			$excluded_items = "";			

			$this->db->select('item_id')

					 ->from('ci_items_pilot')

					 ->where('item_subject_id', $subject_id)

					 ->where('item_type', 'ERQ');

			$query = $this->db->get();

			$result = $query->result();

			foreach($result as $row)

			{

					if($this->count_in_groups_rev($row->item_id) > 0)

					$excluded_items .= $row->item_id.",";

			}

			foreach($result as $row2)

			{

					if($this->count_in_paragraphs_rev($row2->item_id) > 0)

					$excluded_items .= $row2->item_id.",";

			}

			$excluded_items = rtrim($excluded_items, ",");	

			

			

			$SQL ='SELECT GROUP_CONCAT(item_id) as total_crq_ids FROM ci_items_pilot WHERE item_type = "ERQ" AND item_rev_ae_status IN (2,4) AND item_subject_id = '.$subject_id;	

			if(!empty($excluded_items))

			{

				$SQL .= ' AND item_id NOT IN ('.$excluded_items.')  ';

			}							

			$query = $this->db->query($SQL);

			return $query->result();

		}

		public function count_in_groups_rev($item_id)

		{

			$sql="SELECT COUNT(group_id) AS founded FROM `ci_items_group_rev` WHERE group_item_1 = '".$item_id."' OR group_item_2 = '".$item_id."' OR group_item_3 = '".$item_id."' OR group_item_4 = '".$item_id."' OR group_item_5 = '".$item_id."' OR group_item_6 = '".$item_id."' OR group_item_7 = '".$item_id."' OR group_item_8 = '".$item_id."' OR group_item_9 = '".$item_id."' OR group_item_10 = '".$item_id."'";    

		    $query = $this->db->query($sql);

		    $result = $query->result();

			return $result[0]->founded;	

		}

		

		public function count_in_paragraphs_rev($item_id)

		{

			$sql="SELECT COUNT(para_id) AS founded FROM `ci_items_paragraphs_rev` WHERE para_item_21 = '".$item_id."' OR para_item_22 = '".$item_id."' OR para_item_23 = '".$item_id."' OR para_item_24 = '".$item_id."' OR para_item_25 = '".$item_id."' OR para_item_26 = '".$item_id."' OR para_item_27 = '".$item_id."' OR para_item_28 = '".$item_id."' OR para_item_29 = '".$item_id."' OR para_item_30 = '".$item_id."'";    

		    $query = $this->db->query($sql);

		    $result = $query->result();

			return $result[0]->founded;		

		}

		public function getTotalMCQItems($subject_id)

		{

			$excluded_items = "";			

			$this->db->select('item_id')

					 ->from('ci_items_pilot')

					 ->where('item_subject_id', $subject_id)

					 ->where('item_type', 'MCQ');

			$query = $this->db->get();

			$result = $query->result();

			foreach($result as $row)

			{

					if($this->count_in_groups_rev($row->item_id) > 0)

					$excluded_items .= $row->item_id.",";

			}

			foreach($result as $row2)

			{

					if($this->count_in_paragraphs_rev($row2->item_id) > 0)

					$excluded_items .= $row2->item_id.",";

			}

			$excluded_items = rtrim($excluded_items, ",");	

			

			$SQL ='SELECT GROUP_CONCAT(item_id) as total_mcq_ids FROM ci_items_pilot WHERE item_type = "MCQ" AND item_rev_ae_status IN (2,4) AND item_subject_id = '.$subject_id;	

			if(!empty($excluded_items))

			{

				$SQL .= ' AND item_id NOT IN ('.$excluded_items.')  ';

			}							

			$query = $this->db->query($SQL);

			return $query->result_array();



		}

		public function getPilotMCQsVersionsUrduEnglish($phase)

		{			

			$sql = "SELECT * FROM `ci_pilot_papers_mcqs` WHERE p_phase = ".$phase." AND p_subject_id IN (5,9,13,19,26,32,40,48,4,8,12,18,25,31,39,47) ORDER BY p_grade_id ASC, p_subject_id ASC";

			$query = $this->db->query($sql);

			return $query->result_array();

		}

		public function getPilot1_Para_Ids($subject_id, $phase)

		{

			$sql = "SELECT CONCAT(p_m_v1_para_ids,IF(p_m_v2_para_ids!='(NULL)',CONCAT(',',p_m_v2_para_ids),''),IF(p_m_v3_para_ids!='(NULL)',CONCAT(',',p_m_v3_para_ids),''),IF(p_m_v4_para_ids!='(NULL)',CONCAT(',',p_m_v4_para_ids),''),IF(p_m_v5_para_ids!='(NULL)',CONCAT(',',p_m_v5_para_ids),''),IF(p_m_v6_para_ids!='(NULL)',CONCAT(',',p_m_v6_para_ids),''),IF(p_m_v7_para_ids!='(NULL)',CONCAT(',',p_m_v7_para_ids),''),IF(p_m_v8_para_ids!='(NULL)',CONCAT(',',p_m_v8_para_ids),'')) as p1_para_ids FROM `ci_pilot_papers_mcqs`  WHERE p_subject_id = ".$subject_id." AND p_phase = ".$phase;

			$query = $this->db->query($sql);

			return $query->result_array();

		}

		public function getAll_Para_Ids($subject_id)

		{

			$sql = "SELECT GROUP_CONCAT(para_id)  AS all_para_ids FROM `ci_items_paragraphs_pilot` LEFT JOIN `ci_items_pilot` i1 ON i1.item_id = para_item_21 WHERE para_rev_ae_status = 2 AND i1.item_type = 'MCQ' AND para_subject_id = ".$subject_id;

			$query = $this->db->query($sql);

			return $query->result_array();

		}

		public function getAllPilotParaMCQItems($subject_id)

		{

			$sql = "SELECT GROUP_CONCAT(CONCAT(IF(para_item_21!=0,para_item_21,''),IF(para_item_22!=0,CONCAT(',',para_item_22),''),IF(para_item_23!=0,CONCAT(',',para_item_23),''),IF(para_item_24!=0,CONCAT(',',para_item_24),''),IF(para_item_25!=0,CONCAT(',',para_item_25),''),IF(para_item_26!=0,CONCAT(',',para_item_26),''),IF(para_item_27!=0,CONCAT(',',para_item_27),''),IF(para_item_28!=0,CONCAT(',',para_item_28),''))) as mcqs FROM `ci_items_paragraphs_pilot` LEFT JOIN `ci_items_pilot` i1 ON i1.item_id = para_item_21 WHERE para_rev_ae_status IN (2,4) AND para_subject_id  = ".$subject_id." AND i1.item_type = 'MCQ' ";

			$query = $this->db->query($sql);

			return $query->result_array();

		}

		public function getVersions()

		{

			$sqlx="SELECT p_subject_id, p_m_total_mcqs, p_m_versions, p_m_versions_distr FROM `ci_pilot_papers_mcqs` ";

			$queryx = $this->db->query($sqlx);

			$resultx =  $queryx->result();

			

			foreach($resultx as $rowx)

			{

				$versions = $rowx->p_m_versions;			

			$subject_id =$rowx->p_subject_id;

			$sql="SELECT ci_subcontent_stands.subcs_number, ci_items_pilot.* FROM `ci_items_pilot` LEFT JOIN `ci_subcontent_stands` ON subcs_id =  item_subcstand_id  WHERE item_subject_id = ".$subject_id." AND subcs_phase = 2 AND item_type = 'MCQ' ORDER BY subcs_number ASC ";

			$query = $this->db->query($sql);

			$result =  $query->result();

			

			$v1=[];

			$v2=[];

			$v3=[];

			$v4=[];

			$v5=[];

			$v6=[];

			$v7=[];

			$v8=[];

			$v9=[];

			$i=0;

			foreach($result as $row)

			{

				if($i%$versions==0)

				{

					$v1[] = $row->item_id; 

				}

				if($i%$versions==1)

				{

					$v2[] = $row->item_id; 

				}

				if($i%$versions==2)

				{

					$v3[] = $row->item_id; 

				}

				if($i%$versions==3)

				{

					$v4[] = $row->item_id; 

				}

				if($i%$versions==4)

				{

					$v5[] = $row->item_id; 

				}

				if($i%$versions==5)

				{

					$v6[] = $row->item_id; 

				}

				if($i%$versions==6)

				{

					$v7[] = $row->item_id; 

				}

				if($i%$versions==7)

				{

					$v8[] = $row->item_id; 

				}

				if($i%$versions==8)

				{

					$v9[] = $row->item_id; 

				}

				

				$i++;

			}

			

			

			echo '<hr />----------- start: Subject:['.$subject_id.'] and Versions ['.$versions.']-----------start-------<br />';			

			print(implode(", ",$v1));

				$v1x = implode(", ",$v1);

			echo '<hr />';

			print(implode(", ",$v2));

				$v2x = implode(", ",$v2);

			echo '<hr />';

			print(implode(", ",$v3));

				$v3x = implode(", ",$v3);

			echo '<hr />';

			print(implode(", ",$v4));

				$v4x = implode(", ",$v4);

			echo '<hr />';

			print(implode(", ",$v5));

				$v5x = implode(", ",$v5);

			echo '<hr />';

			print(implode(", ",$v6));

				$v6x = implode(", ",$v6);

			echo '<hr />';

			print(implode(", ",$v7));

				$v7x = implode(", ",$v7);

			echo '<hr />';

			print(implode(", ",$v8));

				$v8x = implode(", ",$v8);

			echo '<hr />';

			print(implode(", ",$v9));

				$v9x = implode(", ",$v9);

			echo '<br />---------------------------over -----------------------------<br />';

			

				$qry_insert = "UPDATE ci_pilot_papers_mcqs SET p_m_v1_mcq_ids = '".$v1x."', p_m_v2_mcq_ids = '".$v2x."', p_m_v3_mcq_ids = '".$v3x."', p_m_v4_mcq_ids = '".$v4x."', p_m_v5_mcq_ids = '".$v5x."', p_m_v6_mcq_ids = '".$v6x."', p_m_v7_mcq_ids = '".$v7x."', p_m_v8_mcq_ids = '".$v8x."', p_m_v9_mcq_ids = '".$v9x."' WHERE p_subject_id = ".$subject_id;

			

			echo '<br />'.$qry_insert. '<br />';

			}

			

			

			

			

			die('all over');

			

			



		}

		public function getVersions2()

		{

			$sqlx="SELECT p_subject_id, p_m_total_mcqs, p_m_versions, p_m_versions_distr FROM `ci_pilot_papers_mcqs` ";

			$queryx = $this->db->query($sqlx);

			$resultx =  $queryx->result();

			

			foreach($resultx as $rowx)

			{

				$versions = $rowx->p_m_versions;			

			$subject_id =$rowx->p_subject_id;

			$sql="SELECT ci_subcontent_stands.subcs_number, ci_items_pilot.* FROM `ci_items_pilot` LEFT JOIN `ci_subcontent_stands` ON subcs_id =  item_subcstand_id  WHERE item_subject_id = ".$subject_id." AND subcs_phase = 2 AND item_type = 'MCQ' ORDER BY subcs_number ASC ";

			$query = $this->db->query($sql);

			$result =  $query->result();

			

			$v1=[];

			$v2=[];

			$v3=[];

			$v4=[];

			$v5=[];

			$v6=[];

			$v7=[];

			$v8=[];

			$v9=[];

			$i=0;

			foreach($result as $row)

			{

				if($i%$versions==0)

				{

					$v1[] = $row->item_id; 

				}

				if($i%$versions==1)

				{

					$v2[] = $row->item_id; 

				}

				if($i%$versions==2)

				{

					$v3[] = $row->item_id; 

				}

				if($i%$versions==3)

				{

					$v4[] = $row->item_id; 

				}

				if($i%$versions==4)

				{

					$v5[] = $row->item_id; 

				}

				if($i%$versions==5)

				{

					$v6[] = $row->item_id; 

				}

				if($i%$versions==6)

				{

					$v7[] = $row->item_id; 

				}

				if($i%$versions==7)

				{

					$v8[] = $row->item_id; 

				}

				if($i%$versions==8)

				{

					$v9[] = $row->item_id; 

				}

				

				$i++;

			}

			

			

			echo '<hr />----------- start: Subject:['.$subject_id.'] and Versions ['.$versions.']-----------start-------<br />';			

			print(implode(", ",$v1));

				$v1x = implode(", ",$v1);

			echo '<hr />';

			print(implode(", ",$v2));

				$v2x = implode(", ",$v2);

			echo '<hr />';

			print(implode(", ",$v3));

				$v3x = implode(", ",$v3);

			echo '<hr />';

			print(implode(", ",$v4));

				$v4x = implode(", ",$v4);

			echo '<hr />';

			print(implode(", ",$v5));

				$v5x = implode(", ",$v5);

			echo '<hr />';

			print(implode(", ",$v6));

				$v6x = implode(", ",$v6);

			echo '<hr />';

			print(implode(", ",$v7));

				$v7x = implode(", ",$v7);

			echo '<hr />';

			print(implode(", ",$v8));

				$v8x = implode(", ",$v8);

			echo '<hr />';

			print(implode(", ",$v9));

				$v9x = implode(", ",$v9);

			echo '<br />---------------------------over -----------------------------<br />';

			

				$qry_insert = "UPDATE ci_pilot_papers_mcqs SET p_m_v1_mcq_ids = '".$v1x."', p_m_v2_mcq_ids = '".$v2x."', p_m_v3_mcq_ids = '".$v3x."', p_m_v4_mcq_ids = '".$v4x."', p_m_v5_mcq_ids = '".$v5x."', p_m_v6_mcq_ids = '".$v6x."', p_m_v7_mcq_ids = '".$v7x."', p_m_v8_mcq_ids = '".$v8x."', p_m_v9_mcq_ids = '".$v9x."' WHERE p_subject_id = ".$subject_id;

			

			echo '<br />'.$qry_insert. '<br />';

			}

			

			

			

			

			die('all over');

			

			



		}

		

		public function getVersions_msqs_ids_noparas($subject_id, $phase)

		{

			$arr_eng_urdu = [5,9,13,19,26,32,40,48,4,8,12,18,25,31,39,47];

			if(in_array($subject_id,$arr_eng_urdu)) return true;

			$sqlx="SELECT p_subject_id, p_m_total_mcqs, p_m_versions, p_m_versions_distr FROM `ci_pilot_papers_mcqs` WHERE  p_subject_id = ".$subject_id." AND p_phase = ". $phase;

			

			$queryx = $this->db->query($sqlx);

			$resultx =  $queryx->result();

			

			foreach($resultx as $rowx)

			{

				$versions = $rowx->p_m_versions;			

			$subject_id =$rowx->p_subject_id;

			$sql="SELECT ci_subcontent_stands.subcs_number, ci_items_pilot.* FROM `ci_items_pilot` LEFT JOIN `ci_subcontent_stands` ON subcs_id =  item_subcstand_id  WHERE item_subject_id = ".$subject_id." AND subcs_phase = ".$phase." AND item_type = 'MCQ' ORDER BY subcs_number ASC ";

			$query = $this->db->query($sql);

			$result =  $query->result();

			

			$v1=[];

			$v2=[];

			$v3=[];

			$v4=[];

			$v5=[];

			$v6=[];

			$v7=[];

			$v8=[];

			$i=0;

			foreach($result as $row)

			{

				if($i%$versions==0)

				{

					$v1[] = $row->item_id; 

				}

				if($i%$versions==1)

				{

					$v2[] = $row->item_id; 

				}

				if($i%$versions==2)

				{

					$v3[] = $row->item_id; 

				}

				if($i%$versions==3)

				{

					$v4[] = $row->item_id; 

				}

				if($i%$versions==4)

				{

					$v5[] = $row->item_id; 

				}

				if($i%$versions==5)

				{

					$v6[] = $row->item_id; 

				}

				if($i%$versions==6)

				{

					$v7[] = $row->item_id; 

				}

				if($i%$versions==7)

				{

					$v8[] = $row->item_id; 

				}

				

				$i++;

			}

			

				echo "Subject:['.$subject_id.'] and Versions ['.$versions.'] <br /> Added v1(".count($v1)."), v2(".count($v2)."), v3(".count($v3)."), v4(".count($v4)."), v5(".count($v5)."), v6(".count($v6)."), v7(".count($v7)."), v8(".count($v8).")";

			

			//echo '<hr />----------- start: Subject:['.$subject_id.'] and Versions ['.$versions.']-----------start-------<br />';			

			//print(implode(", ",$v1));

				$v1x = implode(", ",$v1);

			//echo '<hr />';

			//print(implode(", ",$v2));

				$v2x = implode(", ",$v2);

			//echo '<hr />';

			//print(implode(", ",$v3));

				$v3x = implode(", ",$v3);

			//echo '<hr />';

			//print(implode(", ",$v4));

				$v4x = implode(", ",$v4);

			//echo '<hr />';

			//print(implode(", ",$v5));

				$v5x = implode(", ",$v5);

			//echo '<hr />';

			//print(implode(", ",$v6));

				$v6x = implode(", ",$v6);

			//echo '<hr />';

			//print(implode(", ",$v7));

				$v7x = implode(", ",$v7);

			//echo '<hr />';

			//print(implode(", ",$v8));

				$v8x = implode(", ",$v8);

			//echo '<br />---------------------------over -----------------------------<br />';

			

				$qry_update = "UPDATE ci_pilot_papers_mcqs SET p_m_v1_mcq_ids = '".$v1x."', p_m_v2_mcq_ids = '".$v2x."', p_m_v3_mcq_ids = '".$v3x."', p_m_v4_mcq_ids = '".$v4x."', p_m_v5_mcq_ids = '".$v5x."', p_m_v6_mcq_ids = '".$v6x."', p_m_v7_mcq_ids = '".$v7x."', p_m_v8_mcq_ids = '".$v8x."' WHERE p_subject_id = ".$subject_id . " AND p_phase = ".$phase;

			

			//echo '<br />'.$qry_update. '<br />';

			$this->Pilotpaper_model->run_update_query_custom($qry_update);

				

			}

			//die('all over');

		}

		

		public function getParaVersions()

		{

			$sqlx="SELECT * FROM `ci_pilot_papers_mcqs` WHERE p_m_paras_ids != '' AND p_phase = 1";

			$queryx = $this->db->query($sqlx);

			$resultx =  $queryx->result();

			

			foreach($resultx as $rowx)

			{

				$versions = $rowx->p_m_versions;			

				$subject_id =$rowx->p_subject_id;

			

				

				for($i=1;$i<=8;$i++)

				{

					

					if($rowx->{'p_m_v'.$i.'_para_ids'}=='')

					$vpara_ids = [];

					else

					$vpara_ids = explode(",",$rowx->{"p_m_v".$i."_para_ids"});

					if(count($vpara_ids)>0) 

					{					

						$sqlp="SELECT GROUP_CONCAT(CONCAT(IF(para_item_21!=0,para_item_21,''),IF(para_item_22!=0,CONCAT('-',para_item_22),''),IF(para_item_23!=0,CONCAT('-',para_item_23),''),IF(para_item_24!=0,CONCAT('-',para_item_24),''),IF(para_item_25!=0,CONCAT('-',para_item_25),''),IF(para_item_26!=0,CONCAT('-',para_item_26),''),IF(para_item_27!=0,CONCAT('-',para_item_27),''),IF(para_item_28!=0,CONCAT('-',para_item_28),''),IF(para_item_29!=0,CONCAT('-',para_item_29),''),IF(para_item_30!=0,CONCAT('-',para_item_30),''))) AS para_items

	FROM `ci_items_paragraphs_pilot` WHERE para_id IN (".$rowx->{"p_m_v".$i."_para_ids"}.")";

						$queryp = $this->db->query($sqlp);

						$resultp =  $queryp->result();					

						//print_r($resultp);



						$pitems = $resultp[0]->para_items;

						$update_qry = "UPDATE ci_pilot_papers_mcqs SET p_m_v".$i."_para_items = '".$pitems."' WHERE p_subject_id = ".$subject_id." AND p_phase = 1" ;

						echo "<hr />".$update_qry."<hr />";												

						//$queryup = $this->db->query($update_qry);

						//$queryup->result();

						



					} 

				}

				

				

				

				

				

			}

			

			

			

			

			die('all over');

			

			



		}

		

		public function getParaVersions2($subject_id)

		{

			$sqlx="SELECT * FROM `ci_pilot_papers_mcqs` WHERE p_m_paras_ids != '' AND p_phase = 2 AND p_subject_id = ".$subject_id;

			$queryx = $this->db->query($sqlx);

			$resultx =  $queryx->result();

			

			foreach($resultx as $rowx)

			{

				$versions = $rowx->p_m_versions;			

				$subject_id =$rowx->p_subject_id;

			

				$total_para_ids_counts = 0;

				for($i=1;$i<=9;$i++)

				{

					

					if($rowx->{'p_m_v'.$i.'_para_ids'}=='')

					$vpara_ids = [];

					else

					$vpara_ids = explode(",",$rowx->{"p_m_v".$i."_para_ids"});

					if(count($vpara_ids)>0) 

					{					

						$sqlp="SELECT GROUP_CONCAT(CONCAT(IF(para_item_21!=0,para_item_21,''),IF(para_item_22!=0,CONCAT('-',para_item_22),''),IF(para_item_23!=0,CONCAT('-',para_item_23),''),IF(para_item_24!=0,CONCAT('-',para_item_24),''),IF(para_item_25!=0,CONCAT('-',para_item_25),''),IF(para_item_26!=0,CONCAT('-',para_item_26),''),IF(para_item_27!=0,CONCAT('-',para_item_27),''),IF(para_item_28!=0,CONCAT('-',para_item_28),''),IF(para_item_29!=0,CONCAT('-',para_item_29),''),IF(para_item_30!=0,CONCAT('-',para_item_30),''))) AS para_items

	FROM `ci_items_paragraphs_pilot` WHERE para_id IN (".$rowx->{"p_m_v".$i."_para_ids"}.")";

						$queryp = $this->db->query($sqlp);

						$resultp =  $queryp->result();					

						//print_r($resultp);



						$pitems = $resultp[0]->para_items;						

						$items_arr = explode(',',$pitems);

						$total_items = 0;

						if(isset($items_arr[0])){ $sub = explode("-",$items_arr[0]); $total_items = count($sub); }

						if(isset($items_arr[1])){ $sub = explode("-",$items_arr[1]); $total_items += count($sub); }

						if(isset($items_arr[2])){ $sub = explode("-",$items_arr[2]); $total_items += count($sub); }

						if(isset($items_arr[3])){ $sub = explode("-",$items_arr[3]); $total_items += count($sub); }

						

						$update_qry = "UPDATE ci_pilot_papers_mcqs SET p_m_v".$i."_para_items = '".$pitems."', p_m_v".$i."_para_count_ids = ".$total_items." WHERE p_subject_id = ".$subject_id." AND p_phase = 2" ;

						echo "<hr />".$update_qry."<hr />";												

						$queryup = $this->db->query($update_qry);

						//$queryup->result();					

						

						$total_para_ids_counts+= $total_items;



					} 

				}

				

				// update total para mcqs num count as p_m_num_mcqs_para

				$update_qry = "UPDATE ci_pilot_papers_mcqs SET p_m_num_mcqs_para = ".$total_para_ids_counts.", p_m_ind_num_mcqs = ".($rowx->p_m_total_mcqs - $total_para_ids_counts) ." WHERE p_subject_id = ".$subject_id." AND p_phase = 2" ;

						echo "<hr />".$update_qry."<hr />";												

						$queryup = $this->db->query($update_qry);

				

				

				

				

				

			}

			

			

			

			

			echo ('<hr />all over<hr />');

			

			



		}

		

		

		public function getIndivisualMCQsParas()

		{

			$sqlx="SELECT * FROM `ci_pilot_papers_mcqs` WHERE p_m_paras_ids != '' AND p_phase = 1 AND p_subject_id = 26";

			$queryx = $this->db->query($sqlx);

			$resultx =  $queryx->result();

			

			foreach($resultx as $rowx)

			{

				$versions = $rowx->p_m_versions;			

				$subject_id =$rowx->p_subject_id;

				$final_ind_mcq_ids = [];

				

				$sql = "SELECT item_subject_id, ci_subcontent_stands.subcs_number, COUNT(item_id) AS total, GROUP_CONCAT(item_id) AS total_ids, CEIL(COUNT(item_id)/2) AS phase1 FROM `ci_items_pilot`  LEFT JOIN `ci_subcontent_stands` ON subcs_id =  item_subcstand_id  WHERE item_subject_id = ".$subject_id." AND item_type = 'MCQ' AND item_id NOT IN (9816,9829,9846,9861,9864,9873,9839,9856,9871,10274,10292,10316,11276,11290,11316,10670,10686,10721,11379,11383,11390,11260,11267,11298,11265,11295,11309,11895,11901,11897,11966,11998,12021,9477,9483,9487,10160,10134,10151,11722,11719,11715,11743,11787,11751,12127,12192,12156,12189,12175,12181,9907,9937,9944,12954,12940,12950,12799,12817,12922,13127,12982,12994,13227,13270,13298,13353,13350,13355,12440,12554,12203,13117,13052,12971,9714,9708,9700,13587,13590,13592,13741,13781,13794,13012,13035,13099,9769,9764,9792,9590,9815,9832,10305,11397,10325,13866,13894,13833,11595,11404,11411,12754,12793,12843,13952,13984,14023,13856,13875,13914,13774,13370,13829,9926,9890,9917,9823,9843,9838,14187,11372,11409,14204,14209,14212,9962,9953,9942,14350,14124,14349,10929,10960,11560,11703,11584,11629,12890,12938,12977,11927,12054,11977,13495,13498,13476,14075,13786,14087,14380,14381,14379,14388,14391,14384,12196,12282,12300,13843,14252,14261,13109,13417,13240,10554,10560,10569,11505,11506,11833,13990,14386,14389,14393,14394,14395,716,704,14421,14413,14423,1662,1641,1621,2651,2648,2646,716,704,14546,14532,14558,14580,14588,14605,14828,14839,14845,14777,14848,14819,2169,2170,2194,14950,14957,14967,14947,14954,14959,15140,15141,15142,15319,15321,15330,15115,15220,15228,15549,15547,15551,15618,15629,15641,15430,15401,15422,15646,15663,15684,14728,14672,15731,15694,15711,15745,15754,15569,15591,15620,1721,1759,2485,2487,2479,1742,1784,1642,15902,15892,15888,15498,15501,15510,15957,15962,15967,15979,15994,15986,15997,14766,15086,16140,16135,16130,16132,16147,15866,15870,15886,16301,16270,15206,4741,4744,4749,16249,16294,16392,15224,15214,16424,4675,4697,4710,16608,16666,16651,2966,2892,2971,2780,2779,2781,16752,16776,16834,16837,16839,16840,2472,2493,2503,16846,16857,16872,16896,16882,16877,16964,16959,16953,16550,16573,17023,17040,17007,17018,4174,4238,4252,17183,17181,17180,17325,17405,17435,17368,17337,17318,17533,17496,17426,7359,7342,7375,3968,4007,4014,17434,17423,17338,17231,17243,17239,6884,6887,6896,4750,4715,4754,17845,17853,17861,17943,17934,17928,17956,17957,17960,17979,17985,17992,17354,17431,18178,18183,18176,18187,18198,18219,18267,18248,15894,15923,15936,17005,17014,17037,18243,18262,18277,18284,18315,18295,18405,18389,18366,18468,18531,18509,7160,7143,7310,18265,18302,18436,5827,5831,5861,18617,18639,18670,17520,17569,17584,18412,18457,18341,18530,18579,18586,18703,18714,18688,18709,18659,18706,4103,4107,4186,15666,15727,18906,7361,7370,7377,18926,18946,18934,17783,17688,17630,18930,18937,18971,4280,5029,5036,7394,7415,7425,4164,4190,4206,19023,19029,19039,5480,5554,5531,3995,4031,4036,4081,4108,4191,6178,6195,6110,6115,6131,3943,3963,3969,7553,7556,7559,5248,5261,5267,19176,19184,19187,3925,3977,3981,19203,18933,18912,5941,5973,5961,19112,19103,19056,19252,19247,19241,3948,3992,3985,19243,19260,19276,5760,5772,5790,19242,19250,19254,3893,3889,3884,19248,19294,19306,19115,19178,19109,19305,19295,19283,7360,7352,7343,19324,19330,19335,19298,19314,19341,4187,4261,4222,19255,18791,18580,18609,19134,18571,19352,19362,19367,3872,3888,3882,3911,3931,3987,3960,4023,4004,19409,19413,19419,4055,4032,3990,4629,4636,4633,3945,3978,3998,5792,5842,5802,5587,5595,5848,6113,6124,6138,4721,4729,4736,19511,19525,19534,5855,5849,5793,19499,19513,19536,6209,6199,6180,4201,4237,4258,7489,7514,7506,2148,2149,19641,19036,19625,19655,19669,19680,19539,19542,19551,19557,19560,19574,18653,18661,18671,19814,19726,19715,19602,19605,19607,4167,4209,4233,4269,4300,4381,19826,19854,19849,15389,15406,15503,17408,17377,17401,20173,20155,20121,20245,20040,20033,19992,19994,19983,20343,20335,20340,20291,20325,20361,20213,20427,20420,20545,20535,20572,20659,20614,20635,20654,20660,20679,20662,20670,20680,20586,20622,20838,20990,20983,20974,21010,21147,21178,21225,21138,21214,21163,21170,21179,21272,21261,21246,21016,21004,20667,21301,21286,21310,21432,21450,21445,21467,21462,21460,21530,21534,21538,21653,21655,21654,21484,21517,21727,21725,21732,21741,21757,21778,21786,21291,21308,21322,7150,6072,5950,21831,21804,21812,12337,12343,12352,13484,13468,13474,4607,4457,4380,21352,21361,21368,22365,22372,22369,22396,22402,22400,22230,22248,22266,21633,21635,21640,21643,21646,22022,22359,22415,22437,22404,22446,22464,21141,22215,22451,22479,22503,22525,22473,22502,22532,22524,22530,22542,22607,22621,22640,22614,22626,22916,22872,22926,22964,23077,23129,23110,22186,22262,23093,23386,23403,23416,23430,23434,23426,22594,22600,22593,23449,23483,23492,23384,23424,23431,23359,23368,23379,23229,23242,23258,23590,23624,23612,21930,21951,21957,21966,21962,21972,23679,23697,23692,23717,23696,23683,23736,23753,23786,23794,23761,23702,23065,23073,23070,23869,23884,23892,23906,23773,23676,24065,24060,24048,24079,24117,24098,24059,24085,24092,23455,23444,23452,24123,24143,24154,24122,24169,24177,24283,23766,24264,24245,24280,24295,24246,24275,24331,24364,24340,24309,24329,24346,24356,24300,24416,24373,24414,24375,24418,21798,21808,21824,21836,21842,21854,21866,21878,21887,24446,24441,24444,23030,23037,23047,23066,23087,23097,23506,23513,23635,23104,23117,23158,24472,24469,24461,24501,24493,24489,24509,24498,24505,24548,24572,24538,24574,24581,24592,24595,24599,24605,24617,24620,24676,24687,24695,24525,24526,24528,24782,24763,24751,24608,24531,24615,24902,24913,24924,23858,23981,24012,24843,24900,24861,24399,24401,24891,24971,24926,25004,24919,24929,24938,24966,24973,24986,25009,25020,25031,25056,25044,25034,24955,24960,24962,24944,24951,24953,25089,25083,25106,25109,25122,25127,25195,25200,25189,1149,1152,1154,25331,25333,25339,25409,25403,25419,14396,25440,6134,6069,5940,6409,6418,6430,14556,14586,14613,15632,15647,15769,16847,17148,17152,18083,18084,19421,15218,15273,15292,4523,4922,25539,19503,19491,25483,1203,1207,1213,25448,25462,25193,5112,5173,5395,5864,6100,6774,17427,17440,25583,25554,25674,25609,25641,25699,25732,25781,23261,25809,26007,26024,26044,26371,26380,26389,1659,1705,3253,9798,9809,9820,10651,10749,11429,11590,11613,11634,9720,9933,9950,10366,10430,10459,11465,11487,11478,13416,13448,13470,26908,12283,12287,26925,13600,13597,13631,13544,13633,13638,13641,13642,27051,27053,27108,27110,27114,27116,27117,27127,27120,12375,12389,12417,13640,13680,13730,27130,27152,27140,25583,25724,25757,27160,27163,27165,1008,1011,1019,1028,1034,1040,24718,24720,24723,1328,1388,1445,27167,27169,27178,27234,27239,27249,27254,27259,27264,27297,27306,27323,27359,27360,27357,27437,27435,27438,27446,27465,27455,27470,27467,27461,27469,27489,27478,27513,27487,27518,13741,13781,13794,27572,27504,27497,27576,27577,27580,27593,27596,27605,27624,27631,27634,27702,27705,27706,27791,27896,27895,27899,27900,27898,16031,16024,16013,18810,5911,18851,1678,1717,1702,27921,27922,27918,26539,26572,26558,27989,27982,27996,28007,28013,28019,28021,28026,28032,28031,28033,28106,28180,28191,28215,28232,28240,28242,28538,28542,28552,26406,26561,26573,26583,26589,26608,26613,26617,26622,3259,3249,3262,28519,28521,28522,28524,28526,28528,28698,28705,28709,15008,15054,15114,17135,17365,17468,17655,17749,17823,28811,28815,28813,2086,2101,2091,2151,2153,2154,15638,15656,15674,14637,14678,14707,16681,16695,16926,17560,17583,17590,17427,17440,25583,13699,18993,13502,19207,11146,13522,13888,29085,13205,10937,12410,14146,11467,11469,11471,4543,10973,11182,12418,12428,7950,12498,12585,29162,12469,4532,12406,14160,1580,14210,10323,12664,10288,12728,12186,12882,29211,29212,14191,14213,12164,29219,13888,12183,12195,12365,12368,1566,12916,11982,11975,11984,12792,11831,14214,14232,9896,11854,11876,28370,11353,28371,13121,11366,27364,29177,29179,29206,29195,29220,29201,29216,29204,28368,28136,13964,28373,11841,29180,28368,28374,13852,13982,29221,29203,28147,28220,28147,28220,29215,29207,11227,14228,28219,28096,28219,28096,28173,28097,11894,11909,28084,28571,28144,28574,24460,28565,28100,24125,24148,23947,23955,23949,28093,24193,28222,13300,28221,24196,28224,24186,7062,7177,7239,7402,7574,7528,5128,5197,5229,5355,5524,5791,21252,21263,21270,21244,21237,21232,29115,29197,29194,21834,21871,21900,22072,22089,22111,22902,22927,22947,23024,23049,23081,24379,24398,24426,29198,29199,29200,24576,24553,24598,29209,29241,29242,29243,29244,29245,29246,29248,29249,12113,11220,11130,14340,12027,8733,14335,12208,11380,11453,14348,12721,11949,19580,8721,3853,3916,8723,3896,8728,3928,8731,8730,3994,12091,11399,8732,8733,4034,4073,23426,23430,23434,12410,18993,29311,19153,18993,13685,13767,19207,29084,13502,13497,11146,12600,12436,11499,14325,13524,14326,13500,18993,13699,13502,14191,14214,13525,11120,13525,10698,29313,19153,29314,12792,29315,12062,12515,10326,23686,23707,23735,9775,9772,3684,10544,10551,9750,11790,10592,11811,1591,1624,1607,1847,11832,1918,1947,12337,12352,13484,12343,13474,12832,12819,12856,11936,11945,11929,10598,10585,10604,10556,10566,10566,1726,1736,1916,1924,1932,1942,28173,28219,28173,28219,28171,28096,28220,28147,25705,25724,19733,11960,28097,11284,28136,28371,28373,28227,28372,28370,28374,13289,24108,28224,24178,23947,24186,28221,24193,28222,24196,27308,12829,27313,27315,27371,13041,12183,12213,28126,28146,28154,28160,12365,12368,28251,28325,11227,12850,11284,13121,12728,12186,29343,10326,10615,10614,10619,7591,8828,8824,15710,15729,15983,20672,22189,22229,18006,18023,19310,17010,17030,17048,23222,23301,24380,24392,24430,24455,24476,25091,25103,25108,25124,25126,25129,25132,25135,15103,15117,15313,22254,22276,22309,1884,1990,2011,4498,4528,5114,5562,5603,5688,5723,5741,5758,14481,14502,14528,14576,14584,14595,17259,17311,17326,17259,17311,17326,5372,5466,5507,28692,28695,28701,29350,10326,29343,10937,29348,10698,29349,11120,14952,28261,28259,15267,28425,28422,28423,19041,28260,28421,28427,28424,28420,28426,15087,15267,28421,28424,15877,15900,19521,17295,17093,17394,17295,17394,6485,6554,6616,6648,17136,17137,17138,17139,17140,17142,15014,15020,15044,15059,16915,16927,5774,7038,19926,19927,22552,26685,19928,19930,26746,19935,26738,26763,4755,5242,5528,6679,6856,6866,14811,18628,18628,14823,15774,15785,16611,16777,18549,17314,29351,29352,29353,29354,29353,29355,29356,29357,16942,29366,6737,6732,29368,18303,15704,16214,17442,17451,29478,19549,29361,18938,15217,15695,15562,18836,19538,19543,28360,19543,19846,29389,28360,29392,17371,29392,17430,29482,29478,19549,16755,21613,21620,17284,21638,8955,21632,29326,29328,5730,5744,6007,16735,16709,27961,15312,15320,4531,4910,4942,5683,5880,5925,6769,6780,6801,14488,14621,14664,16277,16306,16349,17512,17542,17561,9705,9719,9733,10518,10522,10523,11615,11496,11494,24983,24995,25011,24922,24935,24941,24956,24964,24972,6285,6290,6295,7137,7161,7193,969,981,1094,13306,29406,29407,17257,19614,17176,18556,18600,29434,29322,29323,29327,19059,18786,18800,18816,18918,19516,19526,29378,29382,19535,19544,20477,20555,20577,21228,21259,21289,980,1332,1350,1446,1490,1538,29118,29119,29120,29155,29156,29158,29160,29161,29175,29181,29178,29182,29453,16966,29456,17868,29461,16942,29462,17143,29463,17850,29359,29515,19934,29472,4998,29543,5000,25583,17427,17466,29560,29464,17143,29465,29359,29463,28420,29567,29566,12271,29568,29527,28343,29509,28345,29536,29559,28354,28050,29575,29576,20607,20623,20618,22139,22150,22156,10581,10586,10668,10873,10678,10878,10908,10897,10912,10915,10917,10927,10940,10932,10985,13583,13588,13579,13595,13599,13601,1256,1260,1265,1246,1249,1251,29299,29298,29300,29301,29305,29306,29307,29308,29309,29909,29910,29911,4796,4884,4896,4899,4901,23800,28299,24610,29935,29936,4803,29943,23978,4150,4102,4205,20891,4159,4091,4172,4150,5205,4172,21189,4205,5194,5366,29977,4085,4119,4063,4123,9295,9297,20726,7550,6245,9298,20724,9297,9296,7524,7524,7629,29981,29983,22181,6918,7055,22225,22216,6962,6918,6980,22237,22878,22805,7460,21847,30789,28326,29824,29823,20314,29821,21421,28337,28338,26196,26199,20288,20314,26191,29825,21421,26786,26785,28342,28340,29826,29825,28341,27137,28341,28344,28350,21423,27145,22043,23294,27139,24937,27141,27145,23315,29927,23984,6790,6817,6795,30000,30004,7450,28586,7479,7661,6790,7640,27142,29927,7373,30010,16727,16730,18753,28050,29361,29478,27952,27956,27957,16712,28095,18742,28095,18742,16735,29399,28059,16742,29499,27958,29381,29384,17451,29478,29385,28045,17284,28045,18836,28099,29381,28050,28059,5744,29537,30081,29538,30083,29387,18753,30056,30064,30061,30064,27952,18398,5730,28349,15312,27956,21624,27961,18513,19547,27957,18681,7225,21638,29329,27958,21642,18732,28348,28361,28358,28099,28095,19538,18584,18742,17422,27956,19527,28050,28353,19554,28045,28356,18797,19554,16735,28050,28059,16755,19549,29361,30142,30145,30151,30155,30161,30165,5530,16721,5568,5602,8954,16077,16094,16086,16712,16727,16730,16735,16742,16755,30172,30176,13729,13690,14372,29196,23951,29205,12383,12386,4088,10066,13056,10066,29315,3008,13895,12454,29315,11678,29085,11917,13895,12919,12050,12097,3016,14326,12588,11499,2578,3011,2543,8725,14301,14303,14214,11737,19207,13492,13685,19100,14146,3947,11130,10521,9896,8729,19207,2549,2543,14346,14301,14344,2538,14296,30469,30432,30470,30433,13021,12010,13241,12372,13275,12374,14374,13666,29211,13728,29218,14235,13021,14368,13241,23864,10340,11329,12915,12008,14237,13082,10340,13209,14237,13849,10340,14294,11097,13082,28084,13156,11894,14297,12365,28377,13852,28577,22604,4796,23320,23543,23661,30205,28133,6224,23320,4803,24533,6079,27372,6083,28124,20537,24533,30142,22604,23336,27372,27379,4884,4899,4896,4901,6224,5465,21524,5529,21912,6263,23214,23363,23281,23369,24119,23515,27391,23535,28230,24170,28501,27405,30145,28237,30151,30155,30205,30194,30199,30191,30193,30161,23395,30165,23566,23800,23654,24239,24190,24519,27571,27574,28238,28243,28713,28717,22113,21539,22944,22143,30169,23224,30170,24319,27661,24586,27661,29935,24277,28252,24032,30172,21807,30000,22643,30771,28250,21828,2893,2904,2898,17101,17492,17106,7416,7448,7462,6626,6575,6675,2893,2898,2904,7242,7391,8078,5995,6241,6040,5896,28590,28592,1360,1293,1263,6078,7329,6135,8803,8801,8798,3660,3669,1870,4482,8418,8385,8399,6298,6323,6146,5841,5989,5899,28538,28542,27984,7688,7760,7596,4359,4494,4439,4188,28548,28550,5141,4973,4976,7374,7530,7420,7004,7040,7079,5615,5702,5681,8794,8254,6126,1570,1526,1553,4336,4409,4369,7525,7568,7592,1574,1590,1602,23129,6093,23110,10283,10294,10304,7680,7713,7508,7180,7366,22155,9727,9709,9721,20614,20659,6052,1296,12599,1286,9821,27549,9850,6128,6236,6201,5898,4452,6843,1303,1390,1309,4242,4277,4293,11099,11101,11173,7517,15521,7682,9881,9902,9835,5967,6015,7775,9741,10766,12789,1900,1915,1954,4451,28594,28596,412,1999,1830,20659,20614,22148,1857,1863,1870,7786,7675,7422,2743,2747,2758,4801,4780,4807,26572,26539,26558,1960,1967,1973,16331,16341,15872,5570,5719,6037,15600,15606,16018,20213,20427,20420,2611,2617,2626,6831,6824,6114,21966,21962,21972,10499,10800,10502,8144,7676,7682,3660,1300,1302,7063,7400,4388,2509,2516,2527,27382,27383,545,27389,27398,27390,3727,3728,1125,1113,1135,3729,2633,1297,9652,4471,4495,4414,3722,3724,3726,12044,12049,12034,6372,6149,6085,2754,474,10369,6986,7117,8025,24902,24913,24924,1608,1610,1308,10214,10208,10190,3718,3717,1314,17236,4437,17322,11475,3721,1307,25056,25044,25034,2041,13229,1340,3669,2642,21173,22248,22266,9503,9692,3515,26841,6650,6216,7539,7563,7779,7419,7439,4571,4371,2902,27374,27380,5797,7295,7476,12966,23405,23393,10875,27386,10810,11192,11217,12345,25059,25077,25082,8521,8523,8527,11401,11387,11358,13282,13791,13832,21429,21431,21433,23602,23605,23606,21683,21685,21686,10638,10642,27384,5997,6168,7540,27369,27378,2023,1378,1406,1428,20415,20431,20447,1430,1482,27343,1159,3716,30462,1255,2814,2815,23597,23610,23627,1305,23396,1315,875,900,9548,21867,21890,21903,24633,24653,24673,3387,3388,3389,3390,3393,3395,4429,7518,3398,3400,3402,9761,9822,9830,1235,10890,9914,11285,11304,11313,12367,12373,13721,11325,11335,11352,2825,2818,2821,1534,1485,4557,19799,19821,19825,19908,21509,21564,23159,23177,23185,28417,28418,28419,11143,11247,11212,9936,9952,9972,1675,1730,1793,3719,2755,2744,1825,1848,6314,6335,6360,6345,9991,10016,10172,11758,11805,11874,12790,13094,12899,1440,1605,1628,4429,7518,15722,7546,1656,1701,1739,7492,7371,7414,7433,10422,10428,10500,7492,7371,7414,7433,11242,11253,11273,12106,11782,11752,12106,12143,12124,13203,13277,13245,4421,4505,9793,9901,9866,10307,10478,10485,11455,11512,11516,25109,27360,7467,12291,12306,12296,12319,12322,12328,13639,13647,13656,1684,1743,1804,5935,5953,5964,2082,2161,2370,2322,2370,30464,13695,2841,2842,2848,2850,2851,2856,29256,29255,29255,8703,8705,2322,5835,5853,5876,5997,8145,7540,24622,24154,24638,25057,25063,25093,5537,5486,5617,25093,25078,25098,25990,26003,26015,20753,20761,20813,4929,4797,4940,6624,6636,6664,22778,22791,22818,6168,7517,4365,23234,23264,23328,14446,14729,14424,5601,5677,5687,6320,6326,6327,4469,6228,6237,5642,5930,5870,26454,26462,26467,6984,7008,7025,6268,6256,6011,6292,6330,6427,22838,25023,25039,6879,6883,6889,6879,6883,6889,6470,6569,6623,16791,16899,16958,7168,7136,7209,24655,24699,8539,6136,6152,15289,5977,6170,6221,5911,18410,15119,1988,2090,2032,2099,2109,2110,12711,12521,12811,1179,28553,28555,2135,11644,12316,1443,1459,1464,1786,1799,1814,28992,29034,29023,4501,4513,4519,1354,1387,1777,1448,1492,1548,4927,4934,4947,4927,4934,4947,23693,23718,23817,29801,29802,29803,29278,29280,29279,28865,28867,28870,4693,4777,4840,2197,1431,2277,21668,21674,23690,2160,2163,2164,1301,1320,1776,28754,28756,28759,1827,1935,1896,6783,6781,6786,28734,28735,28753,21833,22004,22071,11644,11486,11563,5511,5525,5538,9214,3179,2908,2343,2581,1160,28564,28563,28562,6066,6101,6137,6674,6660,6718,16962,16985,17026,22159,22166,22172,5002,5243,5468,7196,7271,7397,6892,6899,6908,15405,15429,16168,7207,7235,7458,6736,6682,6305,28557,28559,28561,6913,6927,6938,3111,3080,9222,9224,3110,3091,3131,6487,3508,3502,3496,6476,6482,6483,8124,10215,22461,8890,8006,8015,28615,8429,28966,30475,8239,30493,30494,30472,30476,30557,30558,1557,8196,30478,8249,22581,22576,30568,2131,30569,8230,8267,27913,27906,30473,30477,10495,10506,12343,2583,3103,3105,3104,3702,30530,30532,8261,8292,8437,19650,4122,8614,27912,30479,8546,30533,27920,27970,30481,30529,3840,4118,28622,30480,30482,30484,3858,4536,4563,4577,4640,8877,27881,22722,30549,3069,27815,28791,8197,8618,27933,8440,30485,27924,30495,28640,28972,3714,3876,11444,4659,26870,15110,15123,30531,30541,6719,7270,3369,11438,6305,6740,3886,4076,4087,8544,14387,27111,27738,27879,30546,30548,30534,30537,3165,4070,8013,3171,3178,3174,26866,9035,9039,19855,19869,19872,26871,28863,28866,29254,17632,3192,4058,4584,5155,9057,10470,10493,9135,9137,19692,13731,26872,30535,30538,12435,30540,30543,9138,3077,9055,11100,28685,3122,10314,8123,10609,8409,17937,8415,19856,8362,28691,3128,8887,11445,8888,17873,8791,10268,22483,8789,28620,8349,8470,16353,8448,8409,8772,8467,27937,27940,8414,29624,15057,17976,8362,8159,18256,29626,8358,8458,3493,3495,8125,28694,28732,27904,27971,8364,8443,27916,27926,10677,1672,941,4597,8706,27923,28646,9227,27892,27925,28606,28970,30486,4604,11508,8471,8472,28643,30497,4604,7930,27884,28719,8364,8443,8204,8206,8207,8351,8369,8406,8410,8412,8419,8459,8456,8464,27089,8461,8466,23149,8604,16635,27909,27908,27943,27946,27972,27973,27974,27975,28193,27976,27978,27979,27995,28184,28188,28189,28190,30561,30563,20579,4447,27360,4587,8401,29589,28608,4287,4331,27357,25581,28378,30505,30489,28199,28264,30488,28609,28610,28263,28265,28650,28375,28376,30570,28266,28268,30487,28968,30496,30490,30506,30498,30499,30501,30579,28610,30502,30504,30574,30575,30503,30507,29168,30576,30580,30581,8208,8403,16635,30492,17829,28458,8373,8402,28262,15963,19116,28272,30500,29165,29167,28727,8925,28459,30634,30635,11038,11080,11122,11307,11350,11922,29163,3096,30577,30578,30564,30565,30566,30567,30570,30559,30551,30552,30571,30572,30567,30570,30553,30554,30560,28611,28733,28618,28460,22061,30551,30552,28378,8630,28461,8921,28376,29167,28614,30574,30544,30547,30699,30701,30702,30706,30708,30709,30691,30692,30712,8477,30726,30719,30683,30684,30685,30686,30687,30689,30690,30693,30696,30698,30703,30707,30711,30713,30717,30720,30724,30728,30729,30734,30735,30737,30741,30745,30747,30749,30752,30760,30697,30682,30680,30681,30662,30660,8411,8507,30710,30738,30704,30700,30669,30676,30675,30638,30632,30663,30665,30718,30678,8417,30664,28697,30732,1773,27835,30556,30761,29167,28378,28697,30732,30631,30633,30636,15499,8454,8449,27977,27923,30483,30474,8198,8210,30628,30629,30630,30625,30626,30627,30603,30604,30605,30647,30648,30508,30767,30650,30652,26869,30517,30657,30659,30661,30668,30672,30536,30542,30545,30694,30731,27889,30750,30755,30757,8687,30722,30725,30727,30758,30759,30742,30743,30666,30716,30715,30739,30751,30509,30768,30510,30771,30721,30723,8423,30670,30598,30600,30511,30774,30512,30779,30513,30771,30514,30779,30733,15049,7487,22878,20304,22339,20730,22339,30792,29929,7240,30852,30852,8300,1228,1244,1238,30573,30579,30730,30744,30746,30793,30795,30797,30798,30799,8878,30852,9236,30853,9300,30853,22896,30853,30104,30433,30103,30432,22043,29945,27139,29946,7373,29947,21423,29930,30854,30860,30855,30861,30856,30862,30857,30863,30858,30864,30859,30865,30677,30679,3694,1640,6464,8879,22548,11668,22325,30794,30796,30800,30801,30802,30769,30770,30772,19429,5100,5089,17411,17290,17024,27516,17798,17766,15028,15046,15063,16346,7474,15869,6108,7587,7642,8175,17312,4448,30467,30468,3675,1840,1865,1903,7128,23221,7158,4540,4542,7188,8530,8534,8535,5905,7282,24607,7227,21344,7250,25957,25046,24495,7131,7194,7232,2209,2233,2222,2558,2571,2583,2117,2115,2116,1933,1519,2233,2117,2119,2118,6182,22457,22177,22126,22177,22457,27644,27658,27647,5439,6653,24589,14366,2124,2122,5152,18909,19106,29310,6129,6775,6775,16923,17414,28325,18007,18007,8106,8213,30909,27683,27686,28313,28440,21999,21993,21985,7582,7475,7570,19174,19191,1953,1957,2052,2059,2079,2059,2060,2265,2272,2273,2286,2299,2302,2312,2314,5910,5943,5966,5975,5999,6098,6107,6123,6144,6157,6133,6123,6147,6155,6183,6051,6342,6343,6347,4431,6283,6291,6303,6319,6341,6880,6890,6900,6906,6909,6051,6490,6508,6548,6587,6748,6749,6750,6751,6752,6753,6754,6755,6756,6757,6922,6939,6951,6973,6990,7012,7023,7133,7214,7260,29944,7249,7286,7324,7341,7336,7340,7349,7363,7388,7509,7537,7521,7519,7545,7484,7571,7606,7614,7623,7481,7494,7504,7526,7583,7507,7515,7522,7534,7549,7652,7663,7662,7665,7658,7663,7669,7674,7685,7698,7750,7753,7757,7767,7772,7727,7732,7734,7738,7744,7829,7849,7858,7865,7869,8034,8036,8039,8043,8046,8275,8278,8280,8282,8284,8363,8367,8370,8462,5872,5886,5901,5913,5917,10746,10761,10770,10776,10784,11055,29172,11073,11077,11084,11500,11501,11525,11527,11529,11608,11611,11625,11631,11657,11664,11622,11643,11660,11665,11677,11687,11616,11627,11635,11647,11661,11675,11777,11785,11792,11815,11824,11837,11773,11781,11799,11820,11827,11845,12235,12238,12245,12247,27726,12341,12342,12344,12348,12349,22782,12425,12434,12438,12446,12400,12407,12422,12431,12447,12457,12461,12467,12471,12479,12490,12464,12480,12522,12547,12560,12583,12505,12519,12537,12548,12553,12573,12607,12384,12394,12402,12404,12629,12635,12643,12200,12631,12649,12665,12673,12658,12688,12706,12731,12755,12663,12683,12726,12756,12803,12835,12854,12861,12880,12883,12889,12780,27395,12815,12831,27394,12948,12952,12955,12960,12962,12876,12918,12959,12965,12973,12964,12620,12783,12859,12944,13020,13023,13032,13039,13046,13124,13129,13133,13145,13147,13104,13113,13123,13150,13154,13161,13171,13182,13189,13195,13200,13220,13230,13242,13259,13268,13321,13326,13339,13344,13329,13341,13344,13363,13366,13367,13368,13369,13373,13374,13376,13377,13378,13356,13358,13360,13361,13386,13382,28951,13392,13394,13396,12747,12774,12784,12805,12867,12891,12907,13397,13403,13408,13413,13420,13435,13443,13449,13453,13455,13460,13463,13472,29754,13479,13483,13488,13496,13501,13503,13505,13507,13511,13744,13750,13753,13759,13765,13770,13709,13719,13723,13749,13779,13785,13813,13878,13881,13889,13899,13892,13906,13913,13929,13938,13946,13771,13963,13778,13969,13973,14069,14078,14104,14111,29751,12979,14118,14125,14129,14133,14145,14109,14121,14128,14132,14142,14151,14138,14152,14159,14167,14184,14188,14168,14170,14173,14175,14180,14174,14192,14197,14198,14201,14282,14283,14284,14285,14286,14287,14310,14313,14319,14345,14347,15232,15235,15238,15241,15245,13562,13567,13571,13576,13582,13585,13668,13670,13673,13679,13682,13686,15602,15821,15830,15843,15854,16105,16106,16107,16111,16114,16227,16231,16237,16240,16243,16268,16273,16278,16281,16291,16297,16302,16576,16668,16692,16784,16793,16748,16758,16764,16774,16775,16782,16917,16925,16928,16931,16937,16950,16911,16916,16960,16963,16967,16972,17082,17085,17089,17092,17094,17099,17107,17108,17109,17110,17111,17114,17115,17116,17117,17118,17120,17122,17123,17124,17126,17128,17129,17131,17132,17133,16999,17320,17327,17330,17335,17340,17457,17464,17470,17477,17634,17638,17764,17774,17779,17784,17787,17821,17828,17837,17843,17848,18040,18041,18042,18043,18044,18045,18047,18048,18049,18050,18051,18052,18053,18045,18055,18056,18057,18058,18059,18060,4856,4861,7192,7316,11877,18092,18096,18097,18101,18301,18122,18126,18127,18133,18136,18143,18147,18152,18154,18158,18164,18167,18170,18171,18312,18317,18321,18322,18326,18334,18338,18339,18340,18345,18355,18358,18363,18365,18370,18349,18364,18380,18403,18416,18431,18551,18558,18567,18575,18581,18612,18621,18645,18647,18651,18655,18715,18722,18727,18731,18739,18748,18760,18769,18711,18725,18751,18767,18919,18741,18755,18758,18765,18813,18833,18838,18840,18847,18853,18857,18866,18869,18871,18872,18878,18885,18888,18799,18861,18905,18914,18923,18917,18925,18928,18936,18942,18948,18950,18954,18959,18966,18949,18967,18980,18990,18998,19007,19133,19139,19147,19154,19162,19138,19142,19149,19158,19164,19169,19183,19188,19201,19195,19208,19213,19124,19132,19157,19166,19181,19186,19332,19338,19340,19342,19344,19333,19350,19353,19354,19355,19359,19407,19408,19410,19412,19414,19415,19431,19444,19458,19466,19469,19471,19489,19522,19553,19546,19548,19550,19522,19550,19553,19546,19548,19575,19577,19579,19582,19584,19634,19636,19640,19643,19647,19688,19691,19697,19700,19702,19705,19741,19742,19745,19747,19749,19751,19753,19738,19743,19746,19752,19755,19820,19824,19827,19832,19833,19838,18696,18698,18699,18701,18702,19870,19848,19851,19867,19874,19877,19881,19886,19878,19880,19882,19885,19888,19892,19899,19901,19905,19906,19910,19911,19913,19950,19953,19955,19958,19960,20028,20031,20043,20046,20052,20733,20734,20737,20738,20739,20906,20908,20912,20918,20934,20938,20466,20468,20471,20479,20481,21022,21027,21032,21052,21057,20486,20487,20491,20503,20504,21145,21149,21152,21153,21156,21159,21162,21166,21172,21177,21183,21561,21598,21580,21585,21591,21582,21584,21592,21600,21604,21609,21586,21596,21602,21606,21614,21795,21797,21801,21806,21815,22132,22144,22183,22196,22202,22531,22534,22536,22539,22545,22675,22679,22682,22683,22686,22687,22690,22692,22743,22744,22745,22746,22747,22748,22749,22750,22751,22753,22754,22755,22784,22785,22789,22792,22794,22799,22804,22848,22852,22859,22866,22871,22877,22884,22887,22891,22903,22914,23022,23028,23035,23039,23048,23227,23232,23236,23239,23246,23247,23253,23196,23203,23280,23291,23300,23307,23266,23283,23292,23298,23309,23312,23324,23382,23391,23394,23402,23407,23415,23652,23653,23655,23657,23658,23659,23877,23878,23882,23883,23886,23888,29116,23958,23959,29117,23961,24058,24063,24068,24076,24082,24113,24135,24307,24326,24342,24349,24568,24570,24578,24582,24583,24539,24541,24542,24543,24545,24547,24590,24594,24628,24632,24636,24641,24644,24647,24705,24710,24715,24719,24724,24734,24740,24741,24744,24750,24752,24772,24776,24778,24780,24784,24786,24717,24773,24779,24785,24789,24804,24806,24808,24811,24860,24863,24875,24876,24877,24880,24881,24883,24893,25041,24907,24910,24916,25084,25114,25116,25117,25118,25119,25120,25121,25133,25134,25136,25137,25138,25139,25223,25226,25228,25230,25231,25229,25232,25234,25236,25238,25240,25256,25258,25259,25260,25262,25477,25482,25493,25496,25500,25706,25710,25715,25720,25722,25723,25735,25754,25766,25772,25785,25783,25788,25794,25796,25802,25806,25873,25874,25875,25878,25880,25882,25883,25887,25889,25893,25895,25899,25901,25907,25908,25910,25912,25914,25915,26010,26011,26012,26014,26017,26019,26021,26022,26350,26354,26355,26357,26358,26363,26148,26153,26156,26161,26168,26122,26141,26129,26132,26137,26189,26193,26198,26202,26207,26214,26216,26246,26250,26253,26446,26448,26449,26451,26453,26457,26458,26472,26475,26477,26478,26479,26480,26619,26626,26631,26637,26640,26641,26567,26595,26600,26605,26609,26611,26614,26618,26621,26625,26628,26630,26631,26633,26650,26657,26665,26670,26674,26676,26656,26661,26664,26667,26671,26675,26679,26680,26681,26682,26683,26684,27056,27058,27060,27061,27063,27076,27078,27081,27085,27088,27123,27128,27132,27133,27134,27347,27350,27351,27354,27356,27526,27529,27531,27533,27534,18663,18665,18667,18672,18674,27985,27987,27988,27990,27991,28048,28049,28052,28054,28057,28063,28066,28080,28085,28086,28428,28429,28430,28431,28432,28508,28511,28514,28515,28516,28876,28877,28878,28879,28881,28883,28884,28885,28886,28887,27883,27885,27886,27888,27890,28914,28915,28916,28920,28921,28923,28924,28927,28928,28929,29086,29087,29088,29089,29090,29107,29108,29109,29110,29111,29150,29151,29152,29153,29154,29262,29263,29264,29265,29266,9022,9024,9028,29283,29284,29289,29291,29293,29294,29295,29296,29297,29302,29303,29304,17460,17474,17515,17505,17490,29388,29391,29393,29394,29395,29401,29402,29403,29404,29405,29408,29409,29410,29411,29412,29413,29414,29415,29416,29417,29418,29419,29420,29421,29422,29423,29424,29425,29426,29427,29428,29429,29430,29431,29432,29433,29435,29436,29437,29438,29439,29440,29441,29442,29443,29444,29446,29447,29448,29449,29451,29469,29470,29473,29474,29476,29486,29487,29488,29489,29490,29491,29492,29494,29495,29497,29496,29498,29501,29503,29505,29544,29545,29546,29547,29548,29549,29550,29551,29552,29553,29554,29555,29556,29557,29558,29561,29562,29563,29564,29565,29570,29571,29572,29573,29574,29577,29578,29579,29580,29581,29516,29517,29518,29519,29520,29631,29632,29633,29634,29635,29591,29592,29594,29596,29598,29600,29602,29605,29608,29609,29610,29611,29627,29628,29629,29680,29681,29682,29683,29684,29686,29687,29688,29690,29691,29693,29694,29695,29696,29697,29706,29707,29708,29709,29710,29711,29712,29713,29714,29715,29727,29729,29730,29732,29733,29736,29738,29739,29741,29742,29755,29756,29757,29758,29759,29783,29784,29785,29786,29787,29788,29789,29790,29791,29793,29777,29778,29779,29780,29781,29782,29807,29808,29809,29810,29814,29816,29817,29820,29822,29827,29828,29829,29830,29831,29832,29844,29845,29846,29848,29849,29879,29880,29881,29883,29885,29836,29850,29851,29852,29853,29854,29861,29863,29865,29867,29869,29874,29875,29876,29877,29878,29882,29884,29887,29888,29889,29890,29891,29892,29894,29895,29916,29917,29918,29919,29920,29921,29922,29923,29924,29925,29937,29938,29939,29940,29941,29948,29949,29950,29951,29952,29953,29954,29955,29956,29957,29958,29959,29960,29962,29963,29964,29965,29966,29967,29968,29969,29970,29971,29972,29973,29974,29976,29978,29980,29982,29986,29987,29988,29989,29990,29991,29992,29993,29995,29997,29994,29996,30001,30002,30003,30007,30008,30009,30011,30013,30014,30016,30017,30019,30024,30014,30016,30017,30019,30024,30018,30020,30021,30023,30026,30028,30029,30030,30031,30032,30033,30034,30035,30036,30037,30038,30039,30040,30041,30042,30043,30045,30048,30049,30051,30053,30044,30047,30050,30052,30054,30055,30057,30059,30060,30058,30062,30063,30111,30113,30114,30117,30118,30120,30122,30123,30126,30128,30129,30131,30134,30136,30137,30139,30140,30141,30143,30144,30146,30147,30148,30149,30150,30152,30156,30157,30158,30159,30174,30175,30178,30179,30177,30211,30212,30213,30214,30215,30216,30217,30218,30219,30220,30221,30222,30223,30224,30225,30226,30227,30228,30229,30230,30231,30232,30233,30234,30235,30236,30237,30238,30239,30240,30241,30242,30243,30244,30245,30247,30250,30246,30248,30249,30251,30252,30253,30255,30257,30259,30262,30254,30256,30258,30263,30266,30260,30264,30265,30268,30271,30267,30269,30270,30272,30274,30273,30275,30276,30277,30280,30278,30279,30281,30283,30284,30282,30285,30286,30287,30288,30289,30290,30291,30292,30293,30294,30295,30296,30298,30300,30297,30299,30301,30302,30303,30305,30307,30308,30310,30311,30304,30306,30309,30312,30313,30314,30315,30316,30317,30318,30319,30320,30321,30323,30324,30328,30330,30334,30341,30345,30331,30333,30335,30339,30343,30329,30332,30336,30340,30344,30337,30338,30342,30346,30347,30351,30352,30353,30354,30355,30348,30349,30350,30356,30357,30358,30359,30360,30361,30362,30363,30364,30365,30366,30367,30368,30369,30370,30371,30372,30373,30374,30375,30376,30377,30383,30384,30385,30386,30387,30388,30389,30390,30391,30392,30393,30394,30395,30396,30397,30261,30398,30399,30400,30401,30402,30403,30404,30405,30406,30407,30408,30409,30410,30411,30412,30413,30414,30415,30416,30447,30448,30449,30450,30451,30452,30453,30454,30455,30456,30436,30437,30438,30439,30440,30457,30458,30459,30460,30461,30815,30816,30817,30818,30819,30820,30821,30822,30825,30826,30827,30828,30829,30830,30831,30832,30833,30834,30835,30836,30837,30838,30839,30840,30841,30842,30843,30844,30845,30846,30847,30848,30849,30850,30851,30866,30867,30868,30869,30870,30871,30872,30873,30874,30875,30876,30877,30878,30879,30880,30881,30882,30884,30888,30889,30890,30891,30892,30893,30900,30895,30896,30897,30898,30899) GROUP BY subcs_number ORDER BY subcs_number ASC ";

			

				

				$query = $this->db->query($sql);

				$result =  $query->result();

				foreach($result as $row)

				{

					$ids = explode(",",$row->total_ids);

					

					for($x=0;$x<$row->phase1; $x++)

					{

						$final_ind_mcq_ids[] =	$ids[$x];				

						

					}

					

				}

				echo '<hr />';

				echo ($sql);

				echo '<hr />';

				echo count($final_ind_mcq_ids).'='.implode(",",$final_ind_mcq_ids);

				echo '<hr />';

				

				$cons = 4; // versions

				$vp1= 40;

				$vp2= 40;

				$vp3= 40;

				$vp4= 40;

				//$vp5= 40;

				//$vp6= 30;

				//$vp7= 30;



				$vp1a= [];

				$vp2a= [];

				$vp3a= [];

				$vp4a= [];

				//$vp5a= [];

				//$vp6a= [];

				//$vp7a= [];

				

				$extra_bucket = [];

				//$final_ind_mcq_ids

				for($z=0;$z<count($final_ind_mcq_ids);$z++)

				{

					if($z%$cons==0&&count($vp1a)<$vp1)

					{

						$vp1a[]= $final_ind_mcq_ids[$z];		

					}

					else if($z%$cons==0&&count($vp1a)>=$vp1)

					{

						$extra_bucket[] = $final_ind_mcq_ids[$z];;

					}

					if($z%$cons==1&&count($vp2a)<$vp2)

					{

						$vp2a[]= $final_ind_mcq_ids[$z];		

					}

					else if($z%$cons==1&&count($vp2a)>=$vp2)

					{

						$extra_bucket[] = $final_ind_mcq_ids[$z];;

					}

					if($z%$cons==2&&count($vp3a)<$vp3)

					{

						$vp3a[]= $final_ind_mcq_ids[$z];		

					}

					else if($z%$cons==2&&count($vp3a)>=$vp3)

					{

						$extra_bucket[] = $final_ind_mcq_ids[$z];;

					}

					if($z%$cons==3&&count($vp4a)<$vp4)

					{

						$vp4a[]= $final_ind_mcq_ids[$z];		

					}

					else if($z%$cons==3&&count($vp4a)>=$vp4)

					{

						$extra_bucket[] = $final_ind_mcq_ids[$z];;

					}

					/*

					if($z%$cons==4&&count($vp5a)<$vp5)

					{

						$vp5a[]= $final_ind_mcq_ids[$z];		

					}

					else if($z%$cons==4&&count($vp5a)>=$vp5)

					{

						$extra_bucket[] = $final_ind_mcq_ids[$z];;

					}

					if($z%$cons==5&&count($vp6a)<$vp6)

					{

						$vp6a[]= $final_ind_mcq_ids[$z];		

					}

					else if($z%$cons==5&&count($vp6a)>=$vp6)

					{

						$extra_bucket[] = $final_ind_mcq_ids[$z];;

					}

					if($z%$cons==6&&count($vp7a)<$vp7)

					{

						$vp7a[]= $final_ind_mcq_ids[$z];		

					}

					else if($z%$cons==6&&count($vp7a)>=$vp7)

					{

						$extra_bucket[] = $final_ind_mcq_ids[$z];;

					}*/

				

					

				}

				

				

				echo '<hr /> Versions <hr />';

				echo (count($vp1a).'='.implode(",",$vp1a)).'<br />';

				echo (count($vp2a).'='.implode(",",$vp2a)).'<br />';

				echo (count($vp3a).'='.implode(",",$vp3a)).'<br />';

				echo (count($vp4a).'='.implode(",",$vp4a)).'<br />';

				//echo (count($vp5a).'='.implode(",",$vp5a)).'<br />';

				//echo (count($vp6a).'='.implode(",",$vp6a)).'<br />';

				//echo (count($vp7a).'='.implode(",",$vp7a)).'<br />Extra:';

				echo (count($extra_bucket).'='.implode(",",$extra_bucket)).'<br /><hr />';

			}

			

			

		}

		

		public function get_Pilot_Paper_Phase($subjectList,$phase=1)

		{

				$sql="SELECT * FROM `ci_pilot_papers_mcqs` LEFT JOIN `ci_subjects` ON p_subject_id = subject_id WHERE p_phase = ".$phase." AND p_subject_id IN (".$subjectList.") ORDER BY p_grade_id, p_subject_id ASC ";

			$query = $this->db->query($sql);

			return $query->result_array();				

			

		}

		public function get_Pilot_Paper_CRQ_Phase($subjectList,$phase=1)

		{

			

				$sql="SELECT * FROM `ci_pilot_papers_crqs` LEFT JOIN `ci_subjects` ON c_subject_id = subject_id WHERE c_phase = ".$phase." AND c_subject_id IN (".$subjectList.") ORDER BY c_grade_id, c_subject_id ASC ";

			$query = $this->db->query($sql);

			return $query->result_array();				

			

			

		}

		public function get_Pilot_Stats($subjectList=0)

		{			

			

			if($subjectList!=0)

			{

				$sql="SELECT (item_grade_id-2) AS Grade,item_subject_id,subject_name_en, COUNT(item_id) AS Pilot_Items,SUM(IF(item_type='MCQ', 1, 0)) AS MCQ_Items,SUM(IF(item_type='ERQ', 1, 0)) AS CRQ_Items, (SELECT COUNT(*) FROM `ci_items_group_pilot` WHERE group_subject_id = item_subject_id AND group_rev_status IN (2,4)) AS Pilot_Groups, (SELECT COUNT(*) FROM `ci_items_paragraphs_pilot` WHERE para_subject_id = item_subject_id AND para_rev_status IN(2,4)) AS Pilot_Paragraphs FROM `ci_items_pilot` LEFT JOIN `ci_subjects` ON item_subject_id = subject_id WHERE item_grade_id NOT IN (1,2,3,4) AND item_subject_id NOT IN (62,63,55,37,45,53) AND item_subject_id IN (".$subjectList.") AND item_rev_ae_status IN (2,4) GROUP BY item_subject_id ORDER BY item_grade_id, item_subject_id ASC ";   

			}

			else

			{

				$sql="SELECT (item_grade_id-2) AS Grade,item_subject_id,subject_name_en, COUNT(item_id) AS Pilot_Items,SUM(IF(item_type='MCQ', 1, 0)) AS MCQ_Items,SUM(IF(item_type='ERQ', 1, 0)) AS CRQ_Items, (SELECT COUNT(*) FROM `ci_items_group_pilot` WHERE group_subject_id = item_subject_id AND group_rev_status IN (2,4)) AS Pilot_Groups, (SELECT COUNT(*) FROM `ci_items_paragraphs_pilot` WHERE para_subject_id = item_subject_id AND para_rev_status IN(2,4)) AS Pilot_Paragraphs FROM `ci_items_pilot` LEFT JOIN `ci_subjects` ON item_subject_id = subject_id WHERE item_grade_id NOT IN (1,2,3,4) AND item_subject_id NOT IN (62,63,55,37,45,53) AND item_rev_ae_status IN (2,4) GROUP BY item_subject_id ORDER BY item_grade_id, item_subject_id ASC ";    

			}			

			$query = $this->db->query($sql);

			return $query->result_array();

		}

        

        public function get_Pilot_Stats_genratepaper($subjectList=0)

		{			

			

			if($subjectList!=0)

			{

				$sql="SELECT (item_grade_id-2) AS Grade,item_subject_id,subject_name_en, COUNT(item_id) AS Pilot_Items,SUM(IF(item_type='MCQ', 1, 0)) AS MCQ_Items,SUM(IF(item_type='ERQ', 1, 0)) AS CRQ_Items, (SELECT COUNT(*) FROM `ci_items_group_pilot` WHERE group_subject_id = item_subject_id AND group_rev_status IN (2,4)) AS Pilot_Groups, (SELECT COUNT(*) FROM `ci_items_paragraphs_pilot` WHERE para_subject_id = item_subject_id AND para_rev_status IN(2,4)) AS Pilot_Paragraphs FROM `ci_items_pilot` LEFT JOIN `ci_subjects` ON item_subject_id = subject_id WHERE item_subject_id IN (".$subjectList.") AND item_rev_ae_status IN (2,4) GROUP BY item_subject_id ORDER BY item_grade_id, item_subject_id ASC ";   

			}

			else

			{

				$sql="SELECT (item_grade_id-2) AS Grade,item_subject_id,subject_name_en, COUNT(item_id) AS Pilot_Items,SUM(IF(item_type='MCQ', 1, 0)) AS MCQ_Items,SUM(IF(item_type='ERQ', 1, 0)) AS CRQ_Items, (SELECT COUNT(*) FROM `ci_items_group_pilot` WHERE group_subject_id = item_subject_id AND group_rev_status IN (2,4)) AS Pilot_Groups, (SELECT COUNT(*) FROM `ci_items_paragraphs_pilot` WHERE para_subject_id = item_subject_id AND para_rev_status IN(2,4)) AS Pilot_Paragraphs FROM `ci_items_pilot` LEFT JOIN `ci_subjects` ON item_subject_id = subject_id WHERE item_rev_ae_status IN (2,4) GROUP BY item_subject_id ORDER BY item_grade_id, item_subject_id ASC ";    

			}			

			$query = $this->db->query($sql);

            //echo $this->db->last_query(); die;

			return $query->result_array();

		}

        

		public function get_Pilot_Stats_Both($subjectList=0)

		{		

			

			if($subjectList!=0)

			{				

				$sql="SELECT (item_grade_id-2) AS Grade,item_subject_id,subject_name_en, COUNT(item_id) AS Pilot_Items, SUM(IF(item_type='MCQ', 1, 0)) AS MCQ_Items, p_m_total_mcqs AS MCQ1_Items, ( SUM(IF(item_type='MCQ', 1, 0)) - p_m_total_mcqs ) AS MCQ2_Items, SUM(IF(item_type='ERQ', 1, 0)) AS CRQ_Items, c_ind_crq_count AS CRQ1_Items, ( SUM(IF(item_type='ERQ', 1, 0)) - c_ind_crq_count ) AS CRQ2_Items, (SELECT COUNT(*) FROM `ci_items_group_pilot` WHERE group_subject_id = item_subject_id AND group_rev_status IN (2,4)) AS Groups, c_group_count AS Groups1, ((SELECT COUNT(*) FROM `ci_items_group_pilot` WHERE group_subject_id = item_subject_id AND group_rev_status IN (2,4)) - c_group_count) AS  Groups2, (SELECT COUNT(*) FROM `ci_items_paragraphs_pilot` WHERE para_subject_id = item_subject_id AND para_rev_status IN(2,4)) AS Paras, c_para_count AS Paras1, (SELECT COUNT(*) FROM `ci_items_paragraphs_pilot` WHERE para_subject_id = item_subject_id AND para_rev_status IN(2,4))  AS Paras2 FROM `ci_items_pilot`  LEFT JOIN `ci_subjects` ON item_subject_id = subject_id  LEFT JOIN `ci_pilot_papers_mcqs` ON p_subject_id = subject_id LEFT JOIN `ci_pilot_papers_crqs` ON c_subject_id = subject_id WHERE item_grade_id NOT IN (1,2,3,4) AND item_subject_id NOT IN (62,63,55,37,45,53) AND item_rev_ae_status IN (2,4) AND p_phase = 1 AND c_phase = 1  AND subject_id IN (".$subjectList.") GROUP BY item_subject_id  ORDER BY item_grade_id, item_subject_id ASC ";  

			}

			else

			{

				$sql="SELECT (item_grade_id-2) AS Grade,item_subject_id,subject_name_en, COUNT(item_id) AS Pilot_Items, SUM(IF(item_type='MCQ', 1, 0)) AS MCQ_Items, p_m_total_mcqs AS MCQ1_Items, ( SUM(IF(item_type='MCQ', 1, 0)) - p_m_total_mcqs ) AS MCQ2_Items, SUM(IF(item_type='ERQ', 1, 0)) AS CRQ_Items, c_ind_crq_count AS CRQ1_Items, ( SUM(IF(item_type='ERQ', 1, 0)) - c_ind_crq_count ) AS CRQ2_Items, (SELECT COUNT(*) FROM `ci_items_group_pilot` WHERE group_subject_id = item_subject_id AND group_rev_status IN (2,4)) AS Groups, c_group_count AS Groups1, ((SELECT COUNT(*) FROM `ci_items_group_pilot` WHERE group_subject_id = item_subject_id AND group_rev_status IN (2,4)) - c_group_count) AS  Groups2, (SELECT COUNT(*) FROM `ci_items_paragraphs_pilot` WHERE para_subject_id = item_subject_id AND para_rev_status IN(2,4)) AS Paras, c_para_count AS Paras1, (SELECT COUNT(*) FROM `ci_items_paragraphs_pilot` WHERE para_subject_id = item_subject_id AND para_rev_status IN(2,4))  AS Paras2 FROM `ci_items_pilot`  LEFT JOIN `ci_subjects` ON item_subject_id = subject_id  LEFT JOIN `ci_pilot_papers_mcqs` ON p_subject_id = subject_id LEFT JOIN `ci_pilot_papers_crqs` ON c_subject_id = subject_id WHERE item_grade_id NOT IN (1,2,3,4) AND item_subject_id NOT IN (62,63,55,37,45,53) AND item_rev_ae_status IN (2,4) AND p_phase = 1 AND c_phase = 1 AND c_phase = 1 GROUP BY item_subject_id  ORDER BY item_grade_id, item_subject_id ASC ";     

			}			

			$query = $this->db->query($sql);

			return $query->result_array();

		}

		

		public function coun_group_item($subjectList=0)

		{

			$sql="SELECT (group_grade_id-2) AS Grade, subject_id, subject_name_en, COUNT(group_id) AS Pilot_Groups, SUM(IF(group_item_1!=0, 1, 0)) AS g1_Items, SUM(IF(group_item_2!=0, 1, 0)) AS g2_Items, SUM(IF(group_item_3!=0, 1, 0)) AS g3_Items, SUM(IF(group_item_4!=0, 1, 0)) AS g4_Items, SUM(IF(group_item_5!=0, 1, 0)) AS g5_Items, SUM(IF(group_item_6!=0, 1, 0)) AS g6_Items, SUM(IF(group_item_7!=0, 1, 0)) AS g7_Items, SUM(IF(group_item_8!=0, 1, 0)) AS g8_Items, SUM(IF(group_item_9!=0, 1, 0)) AS g9_Items, SUM(IF(group_item_10!=0, 1, 0)) AS g10_Items

			FROM `ci_items_group_pilot`

			LEFT JOIN `ci_subjects` ON group_subject_id = subject_id

			WHERE group_grade_id NOT IN (1,2,3,4) AND group_subject_id NOT IN (62,63,55,37,45,53) AND group_subject_id = 14

			GROUP BY group_subject_id

			ORDER BY group_grade_id, group_subject_id ASC";

			$query = $this->db->query($sql);

			return $query->result();

		}

		

		function get_paper_mcqs($id)

		{

			$this->db->select('*')

					 ->from('ci_items_pilot')

					 ->join('ci_subjects', 'subject_id = item_subject_id')

					 ->where('item_subject_id', $id)

					 ->where('item_type', 'MCQ')

					 ->limit(50);	 

			$query = $this->db->get();

			return $result = $query->result();	

		}

		function get_paper_paras($id)

		{

			$this->db->select('*')

					 ->from('ci_items_paragraphs_pilot')

					 ->where('para_subject_id', $id)

					 ->limit(5);	 

			$query = $this->db->get();

			return $result = $query->result();	

		}

		public function get_pilotheader_by_suject($subject)

		{

			if($subject != 0 || $subject != '')

				$wh[] ='ph_paper_subject_en LIKE '."'%".$subject."%'";

				$wh[] ='ph_status = 1';

			

			$WHERE = implode(' and ',$wh);

			

			$this->db->select('*')

				 ->from('ci_pilotheaders')

				 ->where($WHERE);			

			$query = $this->db->get();

			return $result = $query->result_array();

		}

		public function get_item_by_id($item_id)

		{

			$this->db->select('*')

					 ->from('ci_items_pilot')

					 //->join('ci_grades', 'grade_id = item_grade_id')

					 //->join('ci_subjects', 'subject_id = item_subject_id')

					 //->join('ci_admin', 'item_submittedby = admin_id')

					 ->where('item_id', $item_id);

			$query = $this->db->get();

			return $result = $query->result();			

		}

/****************************************************************************************

*                Pilot Paper Summary Report  

****************************************************************************************/

    

            

        public function paper_sumary($p_subject,$p_version,$p_phase)

		{

			$this->db->select('p_m_v'.$p_version.'_mcq_ids as ids')

					 ->from('ci_pilot_papers_mcqs')

					 ->where('p_subject_id', $p_subject)

					 ->where('p_phase', $p_phase);	 

			$query = $this->db->get();

			$result = $query->result();

		 	$ids = $result[0]->ids;

           // echo $ids.'<br>';

            $para_iitem_ids = $this->paper_para_item_ids($p_subject,$p_version,$p_phase);

            if($para_iitem_ids !=''){

              $ids .= ','.$para_iitem_ids; 

                

            }

           // echo 'All $ids'.$ids.'<br>';

			if(empty($ids)||$ids=='(NULL)'||$ids=='')

            {

                $this->session->set_flashdata('error', 'Paper cannot be generated/No item exist!');

                redirect(base_url('admin/pilotpaper'));

            }

            $this->db->select('*')

                     ->from('ci_items_pilot')

                     ->join('ci_subjects', 'subject_id = item_subject_id')

                     ->join('ci_content_stands', 'cs_id = item_cstand_id')

                     ->join('ci_slos', 'slo_id = item_slo_id')

                     ->join('ci_admin', 'admin_id = item_submittedby')

                     ->where('item_subject_id', $p_subject)

                     ->where('item_id IN ('.$ids.')')

					 ->order_by('FIELD(item_id,'.$ids.')');	

             $query = $this->db->get();

              //echo $this->db->last_query(); die();

             return $result = $query->result();

		}

        public function paper_para_item_ids($p_subject,$p_version,$p_phase)

		{

			$this->db->select('p_m_v'.$p_version.'_para_ids as ids')

					 ->from('ci_pilot_papers_mcqs')

					 ->where('p_subject_id', $p_subject)

					 ->where('p_phase', $p_phase);	 

			$query = $this->db->get();

			$result = $query->result();

			$ids = $result[0]->ids;

            

            $item_ids = '';

			if($ids != "")

			{			

				$this->db->select('*')

					 ->from('ci_items_paragraphs_pilot')

					 ->where('para_subject_id', $p_subject)

					 ->where('para_id IN ('.$ids.')');

					 

				$query = $this->db->get();

                //echo $this->db->last_query();

                $para_items_ids_array = array();

				$result = $query->result();	

                foreach($result as $row){

                    //echo '$row->para_item_26'.$row->para_item_26.'<br>';

                    ($row->para_item_21 != "0" && $row->para_item_21 != "" ? $para_items_ids_array[] = $row->para_item_21 : '');

                    ($row->para_item_22 != '0' && $row->para_item_22 != '' ? $para_items_ids_array[] = $row->para_item_22 : '');

                    ($row->para_item_23 != '0' && $row->para_item_23 != '' ? $para_items_ids_array[] = $row->para_item_23 : '');

                    ($row->para_item_24 != '0' && $row->para_item_24 != '' ? $para_items_ids_array[] = $row->para_item_24 : '');

                    ($row->para_item_25 != '0' && $row->para_item_25 != '' ? $para_items_ids_array[] = $row->para_item_25 : '');

                    ($row->para_item_26 != '0' && $row->para_item_26 != '' ? $para_items_ids_array[] = $row->para_item_26 : '');

                    ($row->para_item_27 != '0' && $row->para_item_27 != '' ? $para_items_ids_array[] = $row->para_item_27 : '');

                    ($row->para_item_28 != '0' && $row->para_item_28 != '' ? $para_items_ids_array[] = $row->para_item_28 : '');

                    ($row->para_item_29 != '0' && $row->para_item_29 != ''? $para_items_ids_array[] = $row->para_item_29 : '');

                    ($row->para_item_30 != '0' && $row->para_item_30 != '' ? $para_items_ids_array[] = $row->para_item_30 : '');

                      

                    

                }

               $item_ids = implode(",",$para_items_ids_array);

                

			}

            return  $item_ids;

        }

/****************************************************************************************

*               End Pilot Paper Summary Report  

****************************************************************************************/

		function paper_mcqs($id)

		{

			$temp = explode('_',$id);

			$p_subject = $temp[0];

			$p_version = $temp[1];

			

			$this->db->select('p_m_v'.$p_version.'_mcq_ids as ids')

					 ->from('ci_pilot_papers_mcqs')

					 //->join('ci_subjects', 'subject_id = item_subject_id')

					 ->where('p_subject_id', $p_subject)

					 ->where('p_phase', 1);	 

			$query = $this->db->get();

			$result = $query->result();

			$ids = $result[0]->ids;



			if(empty($ids)||$ids=='(NULL)'||$ids=='')

				{

					$this->session->set_flashdata('error', 'Paper cannot be generated/No item exist!');

					redirect(base_url('admin/pilotpaper'));

					}

				$this->db->select('*')

						 ->from('ci_items_pilot')

						 ->join('ci_subjects', 'subject_id = item_subject_id')

						 ->where('item_subject_id', $p_subject)

						 ->where('item_id IN ('.$ids.')');					 

				$query = $this->db->get();

				return $result = $query->result();	

			

			

		}

		function paper_mcqs2($id)

		{

			

			$temp = explode('_',$id);

			$p_subject = $temp[0];

			$p_version = $temp[1];			

			

			

			$this->db->select('p_m_v'.$p_version.'_mcq_ids as ids')

					 ->from('ci_pilot_papers_mcqs')

					 //->join('ci_subjects', 'subject_id = item_subject_id')

					 ->where('p_subject_id', $p_subject)

					 ->where('p_phase', 2);	 

			$query = $this->db->get();

			$result = $query->result();

			$ids = $result[0]->ids;



			if(empty($ids)||$ids=='(NULL)'||$ids=='')

				{

					$this->session->set_flashdata('error', 'Paper cannot be generated/No item exist!');

					redirect(base_url('admin/pilotpaper'));

					}

				$this->db->select('*')

						 ->from('ci_items_pilot')

						 ->join('ci_subjects', 'subject_id = item_subject_id')

						 ->where('item_subject_id', $p_subject)

						 ->where('item_id IN ('.$ids.')');					 

				$query = $this->db->get();

				return $result = $query->result();	

			

			

		}

		function paper_mcqs_paras($id)

		{

			$temp = explode('_',$id);

			$p_subject = $temp[0];

			$p_version = $temp[1];

			//p_m_v1_para_ids

			$this->db->select('p_m_v'.$p_version.'_para_ids as ids')

					 ->from('ci_pilot_papers_mcqs')

					 //->join('ci_subjects', 'subject_id = item_subject_id')

					 ->where('p_subject_id', $p_subject)

					 ->where('p_phase', 1);	 

			$query = $this->db->get();

			$result = $query->result();

			$ids = $result[0]->ids;

			

			if($ids != "")

			{			

				$this->db->select('*')

					 ->from('ci_items_paragraphs_pilot')

					 ->where('para_subject_id', $id)

					 ->where('para_id IN ('.$ids.')');

					 

				$query = $this->db->get();

				return $result = $query->result();	

			}

			

			

			/*

			

			

			

			$this->db->select('p_m_v'.$p_version.'_mcq_ids as ids')

					 ->from('ci_pilot_papers_mcqs')

					 //->join('ci_subjects', 'subject_id = item_subject_id')

					 ->where('p_subject_id', $p_subject)

					 ->where('p_phase', 1);	 

			$query = $this->db->get();

			$result = $query->result();

			$ids = $result[0]->ids;



			if(empty($ids)||$ids=='(NULL)'||$ids=='')

				{

					$this->session->set_flashdata('error', 'Paper cannot be generated/No item exist!');

					redirect(base_url('admin/pilotpaper'));

					}

				$this->db->select('*')

						 ->from('ci_items_pilot')

						 ->join('ci_subjects', 'subject_id = item_subject_id')

						 ->where('item_subject_id', $p_subject)

						 ->where('item_id IN ('.$ids.')');					 

				$query = $this->db->get();

				return $result = $query->result();	

			*/

			

		}

		

		function paper_mcqs_paras2($id)

		{

			$temp = explode('_',$id);

			$p_subject = $temp[0];

			$p_version = $temp[1];

			//p_m_v1_para_ids

			$this->db->select('p_m_v'.$p_version.'_para_ids as ids')

					 ->from('ci_pilot_papers_mcqs')

					 //->join('ci_subjects', 'subject_id = item_subject_id')

					 ->where('p_subject_id', $p_subject)

					 ->where('p_phase', 2);	 

			$query = $this->db->get();

			$result = $query->result();

			$ids = $result[0]->ids;

			

			if($ids != "")

			{			

				$this->db->select('*')

					 ->from('ci_items_paragraphs_pilot')

					 ->where('para_subject_id', $id)

					 ->where('para_id IN ('.$ids.')');

					 

				$query = $this->db->get();

				return $result = $query->result();	

			}

			

			

			/*

			

			

			

			$this->db->select('p_m_v'.$p_version.'_mcq_ids as ids')

					 ->from('ci_pilot_papers_mcqs')

					 //->join('ci_subjects', 'subject_id = item_subject_id')

					 ->where('p_subject_id', $p_subject)

					 ->where('p_phase', 1);	 

			$query = $this->db->get();

			$result = $query->result();

			$ids = $result[0]->ids;



			if(empty($ids)||$ids=='(NULL)'||$ids=='')

				{

					$this->session->set_flashdata('error', 'Paper cannot be generated/No item exist!');

					redirect(base_url('admin/pilotpaper'));

					}

				$this->db->select('*')

						 ->from('ci_items_pilot')

						 ->join('ci_subjects', 'subject_id = item_subject_id')

						 ->where('item_subject_id', $p_subject)

						 ->where('item_id IN ('.$ids.')');					 

				$query = $this->db->get();

				return $result = $query->result();	

			*/

			

		}

		

		/*

		SELECT (group_grade_id-2) AS Grade,subject_id,subject_name_en, 

		COUNT(group_id) AS Pilot_Groups,

		SUM(IF(group_item_1!=0, 1, 0)) AS g1_Items,SUM(IF(group_item_2!=0, 1, 0)) AS g2_Items,SUM(IF(group_item_3!=0, 1, 0)) AS g3_Items,SUM(IF(group_item_4!=0, 1, 0)) AS g4_Items,SUM(IF(group_item_5!=0, 1, 0)) AS g5_Items,SUM(IF(group_item_6!=0, 1, 0)) AS g6_Items,SUM(IF(group_item_7!=0, 1, 0)) AS g7_Items,SUM(IF(group_item_8!=0, 1, 0)) AS g8_Items,SUM(IF(group_item_9!=0, 1, 0)) AS g9_Items,SUM(IF(group_item_10!=0, 1, 0)) AS g10_Items

		FROM `ci_items_group_pilot`

		LEFT JOIN `ci_subjects` ON group_subject_id = subject_id

		WHERE group_grade_id NOT IN (1,2,3,4) AND group_subject_id NOT IN (62,63,55,37,45,53) AND group_subject_id = 14

		GROUP BY group_subject_id

		ORDER BY group_grade_id, group_subject_id ASC

		*/

		

	

////////////////////////////////////////////////////////////////////////////////////------------------------------------------------------------------------		

		function get_paper_groups($id)

		{

			/*

			SELECT (group_grade_id-2) AS Grades, subject_name_en AS Subjects, ci_items_group_rev.*,p1.item_id AS i1_itemid, p1.item_stem_en, p1.item_stem_ur, subcs_number, p1.item_id AS i2_itemid, p2.item_stem_en, p2.item_stem_ur

FROM `ci_items_group_rev`

LEFT JOIN ci_subjects ON subject_id = group_subject_id 

LEFT JOIN `ci_items_pilot` p1 ON p1.item_id = group_item_1

LEFT JOIN `ci_subcontent_stands` ON  subcs_id = p1.item_subcstand_id

LEFT JOIN `ci_items_pilot` p2 ON p2.item_id = group_item_2

WHERE group_rev_ae_status IN (2,4) AND p1.item_type = 'ERQ'

ORDER BY group_grade_id ASC, group_subject_id ASC

			*/

			$sqlx="SELECT c_group_ids FROM ci_pilot_papers_crqs WHERE c_phase = 1 AND c_subject_id = ".$id ;    

			$queryx = $this->db->query($sqlx);

			$resultx = $queryx->result();			

			

			$sql="SELECT (group_grade_id-2) AS Grades, subject_name_en, subject_code, ci_items_group_pilot.*,p1.item_id AS i1_itemid, p1.item_stem_en, p1.item_stem_ur, subcs_number, p2.item_id AS i2_itemid, p2.item_stem_en, p2.item_stem_ur FROM `ci_items_group_pilot` LEFT JOIN ci_subjects ON subject_id = group_subject_id LEFT JOIN `ci_items_pilot` p1 ON p1.item_id = group_item_1 LEFT JOIN `ci_subcontent_stands` ON  subcs_id = p1.item_subcstand_id LEFT JOIN `ci_items_pilot` p2 ON p2.item_id = group_item_2 WHERE group_rev_ae_status IN (2,4) AND p1.item_type = 'ERQ' AND group_subject_id IN (".$this->session->userdata('subjects_ids').") AND group_subject_id =  ".$id." AND group_id IN (".$resultx[0]->c_group_ids.") ORDER BY group_grade_id ASC, group_subject_id ASC, subcs_number ASC";    

		    $query = $this->db->query($sql);

			return ($query->result());

			

			/*

			$this->db->select('*')

					 ->from('ci_items_group_pilot')//ci_items_group_pilot

					 ->join('ci_subjects', 'subject_id = group_subject_id')

					 ->join('ci_grades', 'grade_id = group_grade_id')

					 ->where('group_rev_ae_status IN (2,4)')

					 ->where('group_subject_id', $id);

					 //->limit(5);	 

			$query = $this->db->get();

			return $result = $query->result();

			*/

		}

		function get_paper_groups2($id)

		{			

			$sqlx="SELECT c_group_ids FROM ci_pilot_papers_crqs WHERE c_phase = 2 AND c_subject_id = ".$id ;    

			$queryx = $this->db->query($sqlx);

			$resultx = $queryx->result();			

			

			$sql="SELECT (group_grade_id-2) AS Grades, subject_name_en, subject_code, ci_items_group_pilot.*,p1.item_id AS i1_itemid, p1.item_stem_en, p1.item_stem_ur, subcs_number, p1.item_id AS i2_itemid, p2.item_stem_en, p2.item_stem_ur FROM `ci_items_group_pilot` LEFT JOIN ci_subjects ON subject_id = group_subject_id LEFT JOIN `ci_items_pilot` p1 ON p1.item_id = group_item_1 LEFT JOIN `ci_subcontent_stands` ON  subcs_id = p1.item_subcstand_id LEFT JOIN `ci_items_pilot` p2 ON p2.item_id = group_item_2 WHERE group_rev_ae_status IN (2,4) AND p1.item_type = 'ERQ' AND group_subject_id IN (".$this->session->userdata('subjects_ids').") AND group_subject_id =  ".$id." AND group_id IN (".$resultx[0]->c_group_ids.") ORDER BY group_grade_id ASC, group_subject_id ASC, subcs_number ASC";    

		    $query = $this->db->query($sql);

			return ($query->result());			

			

		}

////////////////////////////////////////////////////////////////////////////////////------------------------------------------------------------------------		

		public function get_paper_paras_erqs($id)

		{

			/*

			$this->db->select('*')

					 ->from('ci_items_paragraphs_pilot')

					 ->join('ci_subjects', 'subject_id = para_subject_id')

					 ->join('ci_grades', 'grade_id = para_grade_id')

					 ->where('para_rev_ae_status IN (2,4)')

					 ->where('para_subject_id', $id);

					 //->limit(5);	 

			$query = $this->db->get();

			return $result = $query->result();	

			*/

			$sqlx="SELECT c_para_ids FROM ci_pilot_papers_crqs WHERE c_phase = 2 AND c_subject_id = ".$id ;    

			$queryx = $this->db->query($sqlx);

			$resultx = $queryx->result();	

			

			$sql="SELECT (para_grade_id-2) AS Grades, subject_name_en, ci_items_paragraphs_pilot.*,p1.item_id AS i1_itemid, p1.item_stem_en, p1.item_stem_ur, subcs_number, p1.item_id AS i2_itemid, p2.item_stem_en, p2.item_stem_ur FROM `ci_items_paragraphs_pilot` LEFT JOIN ci_subjects ON subject_id = para_subject_id LEFT JOIN `ci_items_pilot` p1 ON p1.item_id = para_item_21 LEFT JOIN `ci_subcontent_stands` ON  subcs_id = p1.item_subcstand_id LEFT JOIN `ci_items_pilot` p2 ON p2.item_id = para_item_22 WHERE para_rev_ae_status IN (2,4) AND p1.item_type = 'ERQ' AND para_subject_id IN (".$this->session->userdata('subjects_ids').") AND para_subject_id =  ".$id." AND para_id IN (".$resultx[0]->c_para_ids.") ORDER BY para_grade_id ASC, para_subject_id ASC, subcs_number ASC";    

		    $query = $this->db->query($sql);

		    return $result = $query->result();

		}

////////////////////////////////////////////////////////////////////////////////////------------------------------------------------------------------------

		/*function paper_mcqs($id)

		{

			$temp = explode('_',$id);

			$p_subject = $temp[0];

			$p_version = $temp[1];

			

			$this->db->select('p_m_v'.$p_version.'_mcq_ids as ids')

					 ->from('ci_pilot_papers_mcqs')

					 //->join('ci_subjects', 'subject_id = item_subject_id')

					 ->where('p_subject_id', $p_subject)

					 ->where('p_phase', 1);	 

			$query = $this->db->get();

			$result = $query->result();

			$ids = $result[0]->ids;



			if(empty($ids)||$ids=='(NULL)'||$ids=='')

				{

					$this->session->set_flashdata('error', 'Paper cannot be generated/No item exist!');

					redirect(base_url('admin/pilotpaper'));

					}

				$this->db->select('*')

						 ->from('ci_items_pilot')

						 ->join('ci_subjects', 'subject_id = item_subject_id')

						 ->where('item_subject_id', $p_subject)

						 ->where('item_id IN ('.$ids.')');					 

				$query = $this->db->get();

				return $result = $query->result();	

			

			

		}*/

	

		public function get_paper_erqs($id)

		{

			$excluded_items = "";

			//$subjectList_arr = explode(',',$subjectList);

			$this->db->select('item_id')

					 ->from('ci_items_pilot')

					 ->where('item_subject_id', $id)

					 ->where('item_rev_ae_status IN (2,4)');

			$query = $this->db->get();

			$result = $query->result();

			foreach($result as $row)

			{

					if($this->count_in_groups_pilot($row->item_id) > 0)

					$excluded_items .= $row->item_id.",";

			}

			foreach($result as $row2)

			{

					if($this->count_in_paragraphs_pilot($row2->item_id) > 0)

					$excluded_items .= $row2->item_id.",";

			}	

			if($excluded_items=='')		

			{

				$excluded_items = 0;

			}

			else

			{

				$excluded_items = rtrim($excluded_items, ",");

			}

		

			$sqlx="SELECT c_ind_crq_ids FROM ci_pilot_papers_crqs WHERE c_phase = 1 AND c_subject_id = ".$id ;    

			$queryx = $this->db->query($sqlx);

			$resultx = $queryx->result();	

			

			

			

			$this->db->select('*')

					 ->from('ci_items_pilot')

					 ->join('ci_subjects', 'subject_id = item_subject_id')

					 ->where('item_subject_id', $id)

					 ->where('item_type', 'ERQ')

					 ->where('item_id NOT IN ('.$excluded_items.')')

 					 ->where('item_id IN ('.$resultx[0]->c_ind_crq_ids.')')

					 ->where('item_rev_ae_status IN (2,4)')

					 ->order_by('FIELD(item_id,'.$resultx[0]->c_ind_crq_ids.')');	

			$query = $this->db->get();

			return $result = $query->result();	

		}

		

		public function get_paper_erqs2($id)

		{			

			$sqlx="SELECT c_ind_crq_ids FROM ci_pilot_papers_crqs WHERE c_phase = 2 AND c_subject_id = ".$id ;    

			$queryx = $this->db->query($sqlx);

			$resultx = $queryx->result();	

			

			$this->db->select('*')

					 ->from('ci_items_pilot')

					 ->join('ci_subjects', 'subject_id = item_subject_id')

					 ->where('item_subject_id', $id)

					 ->where('item_type', 'ERQ')					

 					 ->where('item_id IN ('.$resultx[0]->c_ind_crq_ids.')')

					 ->where('item_rev_ae_status IN (2,4)')

					 ->order_by('FIELD(item_id,'.$resultx[0]->c_ind_crq_ids.')');	

			$query = $this->db->get();

			return $result = $query->result();	

		}

		public function count_in_groups_pilot($item_id)

		{

			$sql="SELECT COUNT(group_id) AS founded FROM `ci_items_group_pilot` WHERE group_item_1 = '".$item_id."' OR group_item_2 = '".$item_id."' OR group_item_3 = '".$item_id."' OR group_item_4 = '".$item_id."' OR group_item_5 = '".$item_id."' OR group_item_6 = '".$item_id."' OR group_item_7 = '".$item_id."' OR group_item_8 = '".$item_id."' OR group_item_9 = '".$item_id."' OR group_item_10 = '".$item_id."'";    

		    $query = $this->db->query($sql);

		    $result = $query->result();

			return $result[0]->founded;	

		}

		public function count_in_paragraphs_pilot($item_id)

		{

			$sql="SELECT COUNT(para_id) AS founded FROM `ci_items_paragraphs_pilot` WHERE para_item_21 = '".$item_id."' OR para_item_22 = '".$item_id."' OR para_item_23 = '".$item_id."' OR para_item_24 = '".$item_id."' OR para_item_25 = '".$item_id."' OR para_item_26 = '".$item_id."' OR para_item_27 = '".$item_id."' OR para_item_28 = '".$item_id."' OR para_item_29 = '".$item_id."' OR para_item_30 = '".$item_id."'";    

		    $query = $this->db->query($sql);

		    $result = $query->result();

			return $result[0]->founded;		

		}

		public function getPilotMCQItems($subject_id,$phase=1)

		{

			$sqlx="SELECT (subject_gradeid-2) AS Grades, subject_name_en AS Subjects, p_m_ind_num_mcqs, CONCAT((IF(p_m_v1_mcq_ids!='(NULL)' AND p_m_v1_mcq_ids!='',p_m_v1_mcq_ids,'')),(IF(p_m_v2_mcq_ids!='(NULL)' AND p_m_v2_mcq_ids!='',CONCAT(',',p_m_v2_mcq_ids),'')),(IF(p_m_v3_mcq_ids!='(NULL)' AND p_m_v3_mcq_ids!='',CONCAT(',',p_m_v3_mcq_ids),'')),'_',(IF(p_m_v4_mcq_ids!='(NULL)' AND p_m_v4_mcq_ids!='',CONCAT(',',p_m_v4_mcq_ids),'')),(IF(p_m_v5_mcq_ids!='(NULL)' AND p_m_v5_mcq_ids!='',CONCAT(',',p_m_v5_mcq_ids),'')),(IF(p_m_v6_mcq_ids!='(NULL)' AND p_m_v6_mcq_ids!='',CONCAT(',',p_m_v6_mcq_ids),'')),(IF(p_m_v7_mcq_ids!='(NULL)' AND p_m_v7_mcq_ids!='',CONCAT(',',p_m_v7_mcq_ids),'')),(IF(p_m_v8_mcq_ids!='(NULL)' AND p_m_v8_mcq_ids!='',CONCAT(',',p_m_v8_mcq_ids),'')),(IF(p_m_v9_mcq_ids!='(NULL)' AND p_m_v9_mcq_ids!='',CONCAT(',',p_m_v9_mcq_ids),'')),(IF(p_m_v10_mcq_ids!='(NULL)' AND p_m_v10_mcq_ids!='',CONCAT(',',p_m_v10_mcq_ids),''))) AS mcq_ids FROM ci_pilot_papers_mcqs LEFT JOIN `ci_subjects` ON (subject_id = p_subject_id) WHERE p_subject_id = ".$subject_id." AND p_phase  = ".$phase." ORDER BY subject_gradeid ASC, subject_id ASC";    

			$queryx = $this->db->query($sqlx);

			return $resultx = $queryx->result();

		}

		public function getPilotCRQItems($subject_id,$phase=1)

		{

			$sqlx="SELECT (subject_gradeid-2) AS Grades, subject_name_en AS Subjects, c_group_count,c_group_ids FROM `ci_pilot_papers_crqs` LEFT JOIN `ci_subjects` ON (subject_id = c_subject_id) WHERE c_phase  = ".$phase." AND c_subject_id = ".$subject_id." ORDER BY subject_gradeid ASC, subject_id ASC";    

			$queryx = $this->db->query($sqlx);

			return $resultx = $queryx->result();

		}

		public function getPilotCRQItemsRemaining($subject_id,$pilot1_items)

		{

			$sql = "SELECT GROUP_CONCAT(ci_items_group_pilot.group_id) AS pilot_groups FROM `ci_items_group_pilot` LEFT JOIN ci_subjects ON subject_id = group_subject_id LEFT JOIN `ci_items_pilot` p1 ON p1.item_id = group_item_1 LEFT JOIN `ci_subcontent_stands` ON  subcs_id = p1.item_subcstand_id LEFT JOIN `ci_items_pilot` p2 ON p2.item_id = group_item_2 WHERE group_rev_ae_status IN (2,4) AND p1.item_type = 'ERQ' AND group_subject_id = ".$subject_id." AND group_id NOT IN (".$pilot1_items.") ORDER BY group_grade_id ASC, group_subject_id ASC, subcs_number ASC";

			

			//die($sql);

			$query = $this->db->query($sql);

			return $result = $query->result();

			

		}

		public function run_update_query_custom($sql)

		{	

			$this->db->query($sql);

		}

		public function get_pilot_result_summary_subjects_by_grade($grade_id,$phase_id)

		{

			/*

			$SQL = "SELECT grade_id,subject_id, (subject_gradeid-2) AS Grades, grade_name_en, subject_name_en AS Subjects, 

            

					(SELECT COUNT(*) FROM `ci_items` WHERE item_status_ae = 1 AND item_subject_id = subject_id) AS C1_Items,

					(SELECT COUNT(*) FROM `ci_items` WHERE item_status_ae = 1 AND item_subject_id = subject_id AND item_type='MCQ') AS C1_MCQ_Items,

                    

                    (SELECT COUNT(*) FROM `ci_items_rev` WHERE  item_rev_status IN (2,4) AND item_subject_id = subject_id) AS C2_IR_Reviewed,

					(SELECT COUNT(*) FROM `ci_items_rev` WHERE  item_rev_status IN (2,4) AND item_subject_id = subject_id AND item_type='MCQ') AS C2_IR_MCQ_Reviewed,



					(SELECT COUNT(*) FROM `ci_items_rev` WHERE  item_rev_status IN (0,1) AND item_subject_id = subject_id) AS C2_IR_Pending,

					(SELECT COUNT(*) FROM `ci_items_rev` WHERE  item_rev_status IN (0,1) AND item_subject_id = subject_id AND item_type='MCQ') AS C2_IR_MCQ_Pending,

                    

					(SELECT COUNT(*) FROM `ci_items_rev` WHERE  item_rev_ae_status IN (2,4) AND item_subject_id = subject_id) AS C2_Reviewed,

					(SELECT COUNT(*) FROM `ci_items_rev` WHERE  item_rev_ae_status IN (2,4) AND item_subject_id = subject_id AND item_type='MCQ') AS C2_MCQ_Reviewed,

					(SELECT COUNT(*) FROM `ci_items_rev` WHERE  item_rev_ss_status = 0 AND item_rev_status IN(2,4) AND item_subject_id = subject_id) AS C2_SS_Pending,

					(SELECT COUNT(*) FROM `ci_items_rev` WHERE  item_rev_ss_status = 0 AND item_rev_status IN(2,4) AND item_subject_id = subject_id AND item_type='MCQ') AS C2_SS_MCQ_Pending,

                    

					(SELECT COUNT(*) FROM `ci_items_rev` WHERE  item_rev_ae_status = 0 AND item_rev_ss_status IN(2,4) AND item_subject_id = subject_id) AS C2_AE_Pending,

					(SELECT COUNT(*) FROM `ci_items_rev` WHERE  item_rev_ae_status = 0 AND item_rev_ss_status IN(2,4) AND item_subject_id = subject_id AND item_type='MCQ') AS C2_AE_MCQ_Pending

					FROM `ci_subjects`

					LEFT JOIN ci_grades ON grade_id = subject_gradeid ";

					

					

					 ->where('item_pilot_phase', $phase_id)

			*/

			$this->db->select('subject_name_en, 

			(SELECT COUNT(*) FROM `ci_items_pilot` WHERE item_sequence != 0 AND item_p_value != 0.0000 AND item_subject_id = subject_id AND item_type = "MCQ") AS piloteditems, 

			(SELECT COUNT(*) FROM `ci_items_pilot` WHERE item_sequence != 0 AND item_p_value != 0.0000 AND item_flag != "" AND item_subject_id = subject_id AND item_type = "MCQ") AS flagitems, 

			(SELECT COUNT(*) FROM `ci_items_pilot` WHERE item_sequence != 0 AND item_p_value != 0.0000 AND item_flag = "" AND item_subject_id = subject_id AND item_type = "MCQ") AS accepteditems')

					 ->from('ci_subjects')

					 ->join('ci_grades', 'grade_id = subject_gradeid')

					 ->where('subject_gradeid', $grade_id);

			$query = $this->db->get();			

			return $result = $query->result();			

		}

		

		public function get_pilot_crq_result_summary_subjects_by_grade($grade_id,$phase_id)

		{

			$this->db->select('subject_name_en, 

			(SELECT COUNT(*) FROM `ci_items_pilot` WHERE item_sequence != 0 AND item_p_value != 0.0000 AND item_subject_id = subject_id AND item_type = "ERQ") AS piloteditems, 

			(SELECT COUNT(*) FROM `ci_items_pilot` WHERE item_sequence != 0 AND item_p_value != 0.0000 AND item_flag != "" AND item_subject_id = subject_id AND item_type = "ERQ") AS flagitems, 

			(SELECT COUNT(*) FROM `ci_items_pilot` WHERE item_sequence != 0 AND item_p_value != 0.0000 AND item_flag = "" AND item_subject_id = subject_id AND item_type = "ERQ") AS accepteditems')

					 ->from('ci_subjects')

					 ->join('ci_grades', 'grade_id = subject_gradeid')

					 ->where('subject_gradeid', $grade_id);

			$query = $this->db->get();			

			return $result = $query->result();			

		}

		

		public function get_paper_group_erqs($id)

		{

			$this->db->select('*')

					 ->from('ci_items_pilot')

					 //->join('ci_subjects', 'subject_id = item_subject_id')

					 ->where('item_id', $id)

					 ->where('item_type', 'ERQ')

					 ->where('item_rev_ae_status IN (2,4)');	

			$query = $this->db->get();

			return $result = $query->result();	

		}

		public function get_pilot_paper_CRQ_subjects($phase=1)

		{

			$sql="SELECT c_subject_id FROM `ci_pilot_papers_crqs` WHERE c_phase = ".$phase." GROUP BY c_subject_id ORDER BY c_grade_id, c_subject_id ASC ";

			$query = $this->db->query($sql);

			return $query->result_array();				

		}

		

		public function get_pilot_paper_MCQ_subjects($phase=1)

		{

			$sql="SELECT p_subject_id FROM `ci_pilot_papers_mcqs` WHERE p_phase = ".$phase." GROUP BY p_subject_id ";

			$query = $this->db->query($sql);

			return $query->result_array();				

		}

		public function get_ind_mcq_ids($pitemids, $subjectid)

		{

			//SELECT *  FROM `ci_items_pilot` WHERE `item_subject_id` = 14 AND `item_type` = 'ERQ'

			$this->db->select( "GROUP_CONCAT(CONCAT(item_id)) AS item_ids, count(item_id) as totalids" )

					 ->from('ci_items_pilot')

                     ->join('ci_slos', 'slo_id = item_slo_id')

					 ->where('item_type', 'MCQ')

					 ->where('item_subject_id', $subjectid)

                     ->order_by('slo_number','ASC');

			if($pitemids != 0)

			{

				$this->db->where('item_id NOT IN ('.$pitemids.')');	

			}

			$query = $this->db->get();

			// echo $this->db->last_query(); die;

			return $result = $query->row_array();

		}

        public function get_ind_mcq_ids_by_phase($pitemids, $subjectid, $phase = 0)

		{

			//SELECT *  FROM `ci_items_pilot` WHERE `item_subject_id` = 14 AND `item_type` = 'ERQ'

			$this->db->select( "GROUP_CONCAT(CONCAT(item_id)) AS item_ids, count(item_id) as totalids" )

					 ->from('ci_items_pilot')

                     ->join('ci_slos', 'slo_id = item_slo_id')

                     ->join('ci_subcontent_stands', 'subcs_id = item_subcstand_id')

					 ->where('item_type', 'MCQ')

					 ->where('item_subject_id', $subjectid)

                     ->order_by('slo_number','ASC');

			if($pitemids != 0)

			{

				$this->db->where('item_id NOT IN ('.$pitemids.')');	

			}

            if($phase != 0 && $phase != 0)

			{

				$this->db->where('subcs_phase',$phase);	

			}

			$query = $this->db->get();

			

			return $result = $query->row_array();

            // echo $this->db->last_query(); die;

		}

		public function get_group_items_ids($subjectid)

		{

			$this->db->select( "GROUP_CONCAT(CONCAT(

			IF(group_item_1!=0,group_item_1,''), 

			IF(group_item_2!=0,CONCAT(',',group_item_2),''), 

			IF(group_item_3!=0,CONCAT(',',group_item_3),''),

			IF(group_item_4!=0,CONCAT(',',group_item_4),''),

			IF(group_item_5!=0,CONCAT(',',group_item_5),''), 

			IF(group_item_6!=0,CONCAT(',',group_item_6),''),

			IF(group_item_7!=0,CONCAT(',',group_item_7),''), 

			IF(group_item_8!=0,CONCAT(',',group_item_8),''),

			IF(group_item_9!=0,CONCAT(',',group_item_9),''), 

			IF(group_item_10!=0,CONCAT(',',group_item_10),'')

			)

			) AS group_items" )

					 ->from('ci_items_group_pilot')

					 ->where('group_subject_id', $subjectid);	

			$query = $this->db->get();

			return $result = $query->row_array();

		}

		public function get_group_ids($subjectid)

		{

			$this->db->select( "GROUP_CONCAT(CONCAT(group_id)) AS group_ids" )

					 ->from('ci_items_group_pilot')

					 ->where('group_subject_id', $subjectid);	

			$query = $this->db->get();

			return $result = $query->row_array();

		}

		public function get_group_items_ids_byphase($subjectid,$phase)

		{

			$this->db->select( "GROUP_CONCAT(CONCAT(

			IF(group_item_1!=0,group_item_1,''), 

			IF(group_item_2!=0,CONCAT(',',group_item_2),''), 

			IF(group_item_3!=0,CONCAT(',',group_item_3),''),

			IF(group_item_4!=0,CONCAT(',',group_item_4),''),

			IF(group_item_5!=0,CONCAT(',',group_item_5),''), 

			IF(group_item_6!=0,CONCAT(',',group_item_6),''),

			IF(group_item_7!=0,CONCAT(',',group_item_7),''), 

			IF(group_item_8!=0,CONCAT(',',group_item_8),''),

			IF(group_item_9!=0,CONCAT(',',group_item_9),''), 

			IF(group_item_10!=0,CONCAT(',',group_item_10),'')

			)

			) AS group_items" )

					 ->from('ci_items_group_pilot')

					 ->join('ci_items_pilot', 'item_id = group_item_1')

					 ->join('ci_slos', 'slo_id = item_slo_id')

                     ->join('ci_subcontent_stands', 'subcs_id = item_subcstand_id')

					 ->where('group_subject_id', $subjectid);

			if($phase != 0 && $phase != 0)

			{

				$this->db->where('subcs_phase',$phase);	

			}

			$query = $this->db->get();

			return $result = $query->row_array();

		}

		public function get_group_ids_byphase($subjectid,$phase)

		{

			

			$this->db->select( "GROUP_CONCAT(CONCAT(group_id)) AS group_ids" )

					 ->from('ci_items_group_pilot')

					 ->join('ci_items_pilot', 'item_id = group_item_1')

					 ->join('ci_slos', 'slo_id = item_slo_id')

                     ->join('ci_subcontent_stands', 'subcs_id = item_subcstand_id')

					 ->where('group_subject_id', $subjectid);

			

			if($phase != 0 && $phase != 0)

			{

				$this->db->where('subcs_phase',$phase);	

			}

			$query = $this->db->get();

			return $result = $query->row_array();

			//echo $this->db->last_query(); die;

			

			$this->db->select( "GROUP_CONCAT(CONCAT(item_id)) AS item_ids, count(item_id) as totalids" )

					 ->from('ci_items_pilot')

                     ->join('ci_slos', 'slo_id = item_slo_id')

                     ->join('ci_subcontent_stands', 'subcs_id = item_subcstand_id')

					 ->where('item_type', 'MCQ')

					 ->where('item_subject_id', $subjectid)

                     ->order_by('slo_number','ASC');

			if($pitemids != 0)

			{

				$this->db->where('item_id NOT IN ('.$pitemids.')');	

			}

            if($phase != 0 && $phase != 0)

			{

				$this->db->where('subcs_phase',$phase);	

			}

			$query = $this->db->get();

			

			return $result = $query->row_array();

		}

				

		public function get_para_ids($subjectid)

		{

			$this->db->select( "GROUP_CONCAT(CONCAT(para_id)) AS para_ids" )

					 ->from('ci_items_paragraphs_pilot')

					 ->where('para_subject_id', $subjectid);	

			$query = $this->db->get();

			return $result = $query->row_array();

		}

		

		public function get_ind_crq_ids($gitemids, $subjectid)

		{

			//SELECT *  FROM `ci_items_pilot` WHERE `item_subject_id` = 14 AND `item_type` = 'ERQ'

			$this->db->select( "GROUP_CONCAT(CONCAT(item_id)) AS item_ids, count(item_id) as totalids" )

					 ->from('ci_items_pilot')

					 ->where('item_type', 'ERQ')

					 ->where('item_subject_id', $subjectid);

			if($gitemids != 0)

			{

				$this->db->where('item_id NOT IN ('.$gitemids.')');	

			}

			$query = $this->db->get();

			 //echo $this->db->last_query(); die;

			return $result = $query->row_array();

		}

		

		public function get_ind_crq_ids_byphase($gitemids, $subjectid, $phase)

		{

			//SELECT *  FROM `ci_items_pilot` WHERE `item_subject_id` = 14 AND `item_type` = 'ERQ'

			$this->db->select( "GROUP_CONCAT(CONCAT(item_id)) AS item_ids, count(item_id) as totalids" )

					 ->from('ci_items_pilot')

					 ->join('ci_slos', 'slo_id = item_slo_id')

                     ->join('ci_subcontent_stands', 'subcs_id = item_subcstand_id')

					 ->where('item_type', 'ERQ')

					 ->where('item_subject_id', $subjectid);

			if($gitemids != 0)

			{

				$this->db->where('item_id NOT IN ('.$gitemids.')');	

			}

			if($phase != 0 && $phase != 0)

			{

				$this->db->where('subcs_phase',$phase);	

			}

			$query = $this->db->get();

			 //echo $this->db->last_query(); die;

			return $result = $query->row_array();

		}

		

		public function get_para_items_ids($subjectid, $paraid = '')

		{

			$this->db->select( "GROUP_CONCAT(CONCAT(

			IF(para_item_21!=0,para_item_21,''), 

			IF(para_item_22!=0,CONCAT(',',para_item_22),''), 

			IF(para_item_23!=0,CONCAT(',',para_item_23),''),

			IF(para_item_24!=0,CONCAT(',',para_item_24),''),

			IF(para_item_25!=0,CONCAT(',',para_item_25),''), 

			IF(para_item_26!=0,CONCAT(',',para_item_26),''),

			IF(para_item_27!=0,CONCAT(',',para_item_27),''), 

			IF(para_item_28!=0,CONCAT(',',para_item_28),''),

			IF(para_item_29!=0,CONCAT(',',para_item_29),''), 

			IF(para_item_30!=0,CONCAT(',',para_item_30),'')

			)

			) AS para_items" )

					 ->from('ci_items_paragraphs_pilot')

					 ->where('para_subject_id', $subjectid);

			

			if($paraid != 0)

			{

				$this->db->where('para_id IN ('.$paraid.')');	

			}

			

			$query = $this->db->get();

            //print $this->db->last_query(); die;

			return $result = $query->row_array();

		}

	}

?>